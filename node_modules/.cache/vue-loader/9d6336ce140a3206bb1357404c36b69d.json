{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\index\\ProblemAnalysis\\ProblemAnalysis.vue?vue&type=style&index=1&lang=css&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\index\\ProblemAnalysis\\ProblemAnalysis.vue","mtime":1558065367534},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\css-loader\\index.js","mtime":1552270042900},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1552270044128},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1552270043529},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import \"~@/assets/css/resetVant.css\";\r\n/* 顶部表头 */\r\n/* .container-problem-analysis .van-nav-bar .van-nav-bar__title {\r\n  font-size: 36px;\r\n  color: #fff;\r\n} */\r\n/*下拉菜单*/\r\n.container-problem-analysis .el-dropdown {\r\n  display: inline-block;\r\n  height: 60px;\r\n  line-height: 80px;\r\n}\r\n.container-problem-analysis .el-dropdown .el-dropdown-link {\r\n  margin-left: 24px;\r\n  /* font-size: 28px; */\r\n}\r\n.container-problem-analysis .el-dropdown .el-dropdown-link img {\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n.el-dropdown-menu {\r\n  background-color: #222832;\r\n  opacity: 0.9;\r\n  border-radius: 8px;\r\n  box-sizing: border-box;\r\n  padding: 0 20px;\r\n  border: 0;\r\n}\r\n.el-dropdown-menu__item {\r\n  color: #fff;\r\n  width: 140px;\r\n  line-height: 85px;\r\n  text-align: center;\r\n  border-bottom: 1px solid #737577;\r\n}\r\n.container-problem-analysis .van-picker {\r\n  font-size: 28px;\r\n}\r\n.container-problem-analysis .van-picker__toolbar {\r\n  height: 82px;\r\n  line-height: 82px;\r\n}\r\n.container-problem-analysis .block {\r\n  line-height: 88px;\r\n  text-align: center;\r\n}\r\n.container-problem-analysis .el-input__inner {\r\n  font-size: 24px;\r\n  color: #333;\r\n}\r\n.container-problem-analysis .el-input__prefix {\r\n  width: 20px;\r\n  height: 20px;\r\n  /* line-height: 20px; */\r\n}\r\n.el-date-picker .el-date-table td span {\r\n  width: 35px;\r\n  height: 35px;\r\n  line-height: 36px;\r\n}\r\n.el-date-picker .el-date-table td, .el-date-picker .el-date-table td div {\r\n  height: 35px;\r\n}\r\n.el-picker-panel {\r\n  width: 100%;\r\n}\r\ndiv.el-date-picker div.el-picker-panel__content {\r\n  width: 96%;\r\n}\r\n",{"version":3,"sources":["ProblemAnalysis.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProblemAnalysis.vue","sourceRoot":"src/components/index/ProblemAnalysis","sourcesContent":["<!-- 问题类型分析 -->\r\n<template>\r\n  <div class=\"container-problem-analysis\">\r\n    <!-- 头部 -->\r\n    <van-nav-bar title=\"问题类型分析\" @click-left=\"goBack\" fixed :border=\"false\" :z-index=\"100\" class=\"my-nav-bar\">\r\n      <span class=\"el-icon-arrow-left fontsize\" slot=\"left\"></span>\r\n    </van-nav-bar>\r\n    <div class=\"wrapper\">\r\n      <el-dropdown trigger=\"click\" @visible-change=\"getBuildingData\" @command=\"handleCommand\" class=\"my-dropdown\">\r\n        <span class=\"el-dropdown-link\">\r\n          <img src=\"../../../assets/imgs/storied_building.png\" alt>\r\n          {{buildingName}}\r\n          <i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n        </span>\r\n        <el-dropdown-menu slot=\"dropdown\" class=\"my-dropdown-menu\">\r\n          <el-dropdown-item command=\"整体楼栋\">整体楼栋</el-dropdown-item>\r\n          <el-dropdown-item v-for=\"(item, index) in buildList\" :key=\"index\" :command=\"item.text\">{{item.text}}</el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </el-dropdown>\r\n      <div class=\"cumulative\">\r\n        <span class=\"start active\" @click=\"startCumulative\">开工累计</span>\r\n        <span class=\"year\" @click=\"actionsheetYear\">{{year}}年</span>\r\n        <span class=\"month\" @click=\"actionsheetMonth\">{{month}}月</span>\r\n        <span class=\"week\" @click=\"actionsheetWeek\">{{week}}周</span>\r\n      </div>\r\n      <div class=\"my_echarts\">\r\n        <div ref=\"myChartBar\" class=\"chart_bar\"></div>\r\n      </div>\r\n    </div>\r\n    \r\n    <van-popup v-model=\"popupShow\" position=\"bottom\">\r\n      <van-picker\r\n        show-toolbar\r\n        :title=\"pickerTitle\"\r\n        :columns=\"columns\"\r\n        :loading=\"pickerLoading\"\r\n        :value-key=\"value_key\"\r\n        @cancel=\"popupShow = false\"\r\n        @confirm=\"onConfirm\"\r\n        class=\"my-picker\"\r\n      />\r\n    </van-popup>\r\n\r\n    <van-actionsheet v-model=\"showYear\">\r\n      <van-picker show-toolbar :columns=\"columnsYear\" @cancel=\"onCancel\" @confirm=\"onConfirm\"/>\r\n    </van-actionsheet>\r\n    <van-actionsheet v-model=\"showMonth\">\r\n      <van-datetime-picker\r\n        v-model=\"currentMonth\"\r\n        type=\"year-month\"\r\n        :max-date=\"maxDate\"\r\n        :formatter=\"formatter\"\r\n      />\r\n    </van-actionsheet>\r\n    <van-actionsheet v-model=\"showWeek\">\r\n      <div class=\"block\">\r\n        <!-- <span class=\"demonstration\">周</span> -->\r\n        <el-date-picker v-model=\"currentWeek\" type=\"week\" format=\"yyyy 第 WW 周\" placeholder=\"选择周\"></el-date-picker>\r\n      </div>\r\n    </van-actionsheet>\r\n  </div>\r\n</template>\r\n\r\n<script type='textecmascript-6'>\r\nimport { GetTypeAnalysis, GetBuilding } from \"@/api/api.js\";\r\nimport echarts from \"echarts\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      ProjectID: localStorage.getItem('projectid'), //项目ID\r\n      userID: localStorage.getItem(\"userId\"), //用户ID\r\n      buildingName: \"整体楼栋\",  //楼栋名称\r\n      dateType: 1,  //数据查询类型（1：累计2：年3：月4：周）\r\n      year: new Date().getFullYear(),\r\n      month: new Date().getMonth() + 1,\r\n      week: 1,\r\n      popupShow: false,  //弹出层是否显示\r\n      pickerLoading: false,  //是否显示加载状态\r\n      pickerTitle: \"\",  //顶部栏标题\r\n      value_key: \"\",  //选项对象中，文字对应的 key\r\n      columns: [],  //对象数组，配置每一列显示的数据\r\n\r\n      showYear: false, //上拉框默认隐藏(年)\r\n      showMonth: false, //上拉框默认隐藏(月)\r\n      showWeek: false,//上拉框默认隐藏(周)\r\n      columnsYear: [\"2015年\", \"2016年\", \"2017年\", \"2018年\", \"2019年\"], //时间选择年\r\n      currentMonth: new Date(), //时间选择月\r\n      currentWeek: new Date(), // 时间选择周\r\n      maxDate: new Date(), //最大选择时间\r\n      barData: [],\r\n      category: [],\r\n      buildList: []  //楼栋集合\r\n    };\r\n  },\r\n  created(){\r\n    this.getTypeAnalysis();\r\n    // this.getBuildingData()\r\n  },\r\n  mounted() {\r\n    \r\n  },\r\n  methods: {\r\n    /**\r\n     * @name 获取问题类型分析数据\r\n     * @param {string} BuildingName 楼栋名称（值为空是查整体）\r\n     * @param {integer} DateType 数据查询类型（1：累计2：年3：月4：周）\r\n     * @param {integer} Year 年\r\n     * @param {integer} Month 月\r\n     * @param {integer} Week 周\r\n     */\r\n    async getTypeAnalysis(){\r\n      let params = {\r\n        ProjectID: this.ProjectID,\r\n        BuildingName: this.buildingName == \"整体楼栋\" ? \"\" : this.buildingName,\r\n        DateType: this.dateType,\r\n        Year: this.year,\r\n        Month: this.month,\r\n        Week: this.week\r\n      };\r\n      let data = await this.Request(GetTypeAnalysis(params));\r\n      this.category = []\r\n      this.barData = []\r\n      if (data.StatusCode === 200) {\r\n        if(data.Detiel.length > 0){\r\n          data.Detiel.forEach(item => {\r\n            this.category.push(item.ProblemType)\r\n            this.barData.push(item.Count)\r\n          })\r\n          this.barChart();\r\n        }else{\r\n          this.$toast({\r\n            message: \"暂无数据！\",\r\n            className: \"my-toast\"\r\n          });\r\n        }\r\n        // console.log(\"==getTypeAnalysis==\", this.category, this.barData)\r\n      } else {\r\n        this.$toast({\r\n          type: \"fail\",\r\n          message: data.message ? data.message : \"后台异常\",\r\n          className: \"my-toast\"\r\n        });\r\n      }\r\n    },\r\n    /**\r\n     * @name 获取模型的楼栋信息\r\n     */\r\n    getBuildingData() {\r\n      this.Request(\r\n        GetBuilding({ projectid: this.ProjectID })\r\n      ).then(data => {\r\n        if (data.StatusCode === 200) {\r\n          if (data.Detiel.length > 0) {\r\n            this.buildList = data.Detiel;\r\n          }else{\r\n            this.buildList = [];\r\n          }\r\n        } else {\r\n          this.$toast({\r\n            className: \"my-toast\",\r\n            type: \"fail\",\r\n            message: data.Message\r\n          });\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * @name 点击菜单项触发的事件回调，用户可以通过相应的菜单项key进行不同的操作\r\n     * @param {dropdown-item 的指令} command key\r\n     */\r\n    handleCommand(command) {\r\n      this.buildingName = command\r\n      this.getTypeAnalysis()\r\n    },\r\n    //返回\r\n    goBack() {\r\n      this.$router.push({ path: \"/Risk\" });\r\n    },\r\n    startCumulative(){\r\n      this.dateType = 1;\r\n      this.getTypeAnalysis();\r\n    },\r\n    //点击年月周显示弹窗\r\n    actionsheetYear() {\r\n      this.pickerTitle = \"年\"\r\n      this.popupShow = true;\r\n      let date = new Date;\r\n      let year = date.getFullYear();\r\n      let years = []\r\n      for(let i = 0; i < 6; i++){\r\n        years.push(Number(year) - i)\r\n      }\r\n      this.dateType = 2;\r\n      this.columns = years;\r\n    },\r\n    actionsheetMonth() {\r\n      this.pickerTitle = \"月\"\r\n      this.popupShow = true;\r\n      this.dateType = 3;\r\n      this.columns = [1,2,3,4,5,6,7,8,9,10,11,12]\r\n    },\r\n    actionsheetWeek() {\r\n      this.pickerTitle = \"周\"\r\n      this.popupShow = true;\r\n      this.dateType = 4;\r\n      this.columns = [1,2,3,4,5]\r\n    },\r\n    //对选项文字进行处理\r\n    formatter(type, value) {\r\n      if (type === \"year\") {\r\n        return `${value}年`;\r\n      } else if (type === \"month\") {\r\n        return `${value}月`;\r\n      }\r\n      return value;\r\n    },\r\n    /**\r\n     * @name 点击完成按钮时触发\r\n     */\r\n    onConfirm(value, index){\r\n      switch (this.pickerTitle) {\r\n        case \"年\":\r\n          {\r\n            this.year = value;\r\n            this.popupShow = false;\r\n            this.getTypeAnalysis();\r\n          }\r\n          break;\r\n        case \"月\":\r\n          {\r\n            this.month = value;\r\n            this.popupShow = false;\r\n            this.getTypeAnalysis();\r\n          }\r\n          break;\r\n        case \"周\":\r\n          {\r\n            this.week = value;\r\n            this.popupShow = false;\r\n            this.getTypeAnalysis();\r\n          }\r\n          break;\r\n      \r\n        default:\r\n          break;\r\n      }\r\n    },\r\n    onCancel() {\r\n      console.log(\"取消\");\r\n      this.showYear = false;\r\n      this.showMonth = false;\r\n      this.showWeek = false;\r\n    },\r\n    //echart横向柱状图\r\n    barChart() {\r\n      var myChart = echarts.init(this.$refs.myChartBar);\r\n      //初始化数据\r\n      var option = {\r\n        tooltip: {\r\n          trigger: \"axis\",\r\n          axisPointer: {\r\n            type: \"shadow\"\r\n          }\r\n        },\r\n        grid: {\r\n          left: \"3%\",\r\n          right: \"4%\",\r\n          top: \"1%\",\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: \"value\",\r\n          show: false,\r\n          axisLine: {\r\n            show: false\r\n          },\r\n          axisTick: {\r\n            show: false\r\n          },\r\n          splitLine: {\r\n            show: false\r\n          }\r\n        },\r\n        yAxis: {\r\n          type: \"category\",\r\n          data: this.category,\r\n          splitLine: { show: false },\r\n          axisLine: {\r\n            show: false\r\n          },\r\n          axisTick: {\r\n            show: false\r\n          },\r\n          offset: 10,\r\n          nameTextStyle: {\r\n            fontSize: 24\r\n          }\r\n        },\r\n        series: [\r\n          {\r\n            name: \"数量\",\r\n            type: \"bar\",\r\n            data: this.barData,\r\n            barWidth: 16,\r\n            barGap: 10,\r\n            smooth: true,\r\n            label: {\r\n              normal: {\r\n                show: true,\r\n                position: \"right\",\r\n                offset: [0, 0],\r\n                textStyle: {\r\n                  color: \"#F68300\",\r\n                  fontSize: 13\r\n                }\r\n              }\r\n            },\r\n            itemStyle: {\r\n              emphasis: {\r\n                barBorderRadius: 7\r\n              },\r\n              normal: {\r\n                barBorderRadius: 7,\r\n                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [\r\n                  { offset: 0, color: \"#3977E6\" },\r\n                  { offset: 1, color: \"#37BBF8\" }\r\n                ])\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      };\r\n      myChart.setOption(option);\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang='stylus' scoped rel='stylesheet/stylus'>\r\n.container-problem-analysis\r\n  width 100%\r\n  height 100%\r\n  background-color #fff\r\n  .van-nav-bar\r\n    // height 88px\r\n    // line-height 88px\r\n    // border-bottom 1px solid #E5E5E5\r\n    // background-color #5892FF\r\n    .fontsize\r\n      // font-size 42px\r\n      // color #fff\r\n      // display inline-block\r\n      // vertical-align middle\r\n    .speed_of_progress\r\n      // width 36px\r\n      // height 36px\r\n  .wrapper\r\n    margin-top 88px\r\n    .cumulative\r\n      width 100%\r\n      height 100px\r\n      line-height 60px\r\n      box-sizing border-box\r\n      padding 20px\r\n      text-align center\r\n      color #4E8CF5\r\n      display flex\r\n      span\r\n        flex 1\r\n        border 1px solid #BDC1C6\r\n        font-size 28px\r\n      .year, .month, .week\r\n        border-left 0\r\n      .active\r\n        background-color #4E8CF5\r\n        color #fff\r\n    .my_echarts\r\n      padding 20px\r\n      .chart_bar\r\n        width 700px\r\n        height 1000px\r\n</style>\r\n<style>\r\n@import \"~@/assets/css/resetVant.css\";\r\n/* 顶部表头 */\r\n/* .container-problem-analysis .van-nav-bar .van-nav-bar__title {\r\n  font-size: 36px;\r\n  color: #fff;\r\n} */\r\n/*下拉菜单*/\r\n.container-problem-analysis .el-dropdown {\r\n  display: inline-block;\r\n  height: 60px;\r\n  line-height: 80px;\r\n}\r\n.container-problem-analysis .el-dropdown .el-dropdown-link {\r\n  margin-left: 24px;\r\n  /* font-size: 28px; */\r\n}\r\n.container-problem-analysis .el-dropdown .el-dropdown-link img {\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n.el-dropdown-menu {\r\n  background-color: #222832;\r\n  opacity: 0.9;\r\n  border-radius: 8px;\r\n  box-sizing: border-box;\r\n  padding: 0 20px;\r\n  border: 0;\r\n}\r\n.el-dropdown-menu__item {\r\n  color: #fff;\r\n  width: 140px;\r\n  line-height: 85px;\r\n  text-align: center;\r\n  border-bottom: 1px solid #737577;\r\n}\r\n.container-problem-analysis .van-picker {\r\n  font-size: 28px;\r\n}\r\n.container-problem-analysis .van-picker__toolbar {\r\n  height: 82px;\r\n  line-height: 82px;\r\n}\r\n.container-problem-analysis .block {\r\n  line-height: 88px;\r\n  text-align: center;\r\n}\r\n.container-problem-analysis .el-input__inner {\r\n  font-size: 24px;\r\n  color: #333;\r\n}\r\n.container-problem-analysis .el-input__prefix {\r\n  width: 20px;\r\n  height: 20px;\r\n  /* line-height: 20px; */\r\n}\r\n.el-date-picker .el-date-table td span {\r\n  width: 35px;\r\n  height: 35px;\r\n  line-height: 36px;\r\n}\r\n.el-date-picker .el-date-table td, .el-date-picker .el-date-table td div {\r\n  height: 35px;\r\n}\r\n.el-picker-panel {\r\n  width: 100%;\r\n}\r\ndiv.el-date-picker div.el-picker-panel__content {\r\n  width: 96%;\r\n}\r\n</style>\r\n"]}]}