{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\index\\quality\\quality.vue?vue&type=style&index=1&lang=css&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\index\\quality\\quality.vue","mtime":1557717670499},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\css-loader\\index.js","mtime":1552270042900},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1552270044128},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1552270043529},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 顶部表头 */\n.container-quality .van-nav-bar .van-nav-bar__title {\n  font-size: 36px;\n}\n/*tab切换栏*/\n.container-quality .van-tab span {\n  font-size: 30px;\n  line-height: 80px;\n}\n.container-quality .van-tabs--line .van-tabs__wrap {\n  height: 80px;\n}\n.container-quality .van-tabs--line .van-tabs__wrap {\n  color: #666;\n  position: fixed;\n  top: 88px !important;\n}\n.container-quality .van-tabs--line .van-tabs__wrap .van-tabs__nav {\n  background-color: #fff;\n}\n.container-quality .van-tab--active {\n  color: #5a92ff;\n}\n/* tab下边线 */\n.container-quality .van-hairline--top-bottom::after {\n  border-width: 0 0 2px 0;\n}\n.container-quality .van-tabs--line {\n  padding-top: 80px;\n}\n.container-quality .van-tabs__line {\n  height: 4px;\n  bottom: 19px;\n  width: 120px;\n  bottom: 21px;\n  background-color: #5a92ff;\n}\n/* .container-quality .van-tabs__content {\n  margin-top: 88px;\n} */\n/* 搜索栏 */\n.container-quality .van-search {\n  height: 98px;\n  padding: 17px 24px;\n}\n.container-quality .van-search .van-search__content {\n  height: 64px;\n  border-radius: 0;\n}\n.container-quality .van-search .van-search__content .van-cell {\n  line-height: 64px;\n  font-size: 28px;\n}\n.container-quality .van-search .van-search__content .van-cell .van-icon {\n  font-size: 40px;\n}\n.container-quality .van-search__action {\n  width: 120px;\n  line-height: 64px;\n  color: #fff;\n  font-size: 30px;\n  text-align: center;\n  background: rgba(88, 146, 255, 1);\n  border-radius: 8px;\n  margin-left: 18px;\n}\n/*表格*/\n.container-quality .el-table {\n  color: #333;\n  font-size: 24px;\n}\n.container-quality .el-table thead tr th {\n  background-color: #5892ff;\n  color: #fff;\n}\n.container-quality .el-table .cell {\n  line-height: 76px;\n}\n.container-quality .el-table th div {\n  vertical-align: middle;\n  color: #fff;\n}\n.el-dropdown-link{font-size: 24px;}\n/* .container-quality .el-icon--right {\n  width: 18px;\n  height: 9px;\n  display: inline-block;\n  background-image: url('../../../assets/imgs/bottom.png');\n  background-size: 100% 100%;\n  background-position: center;\n  background-color: #fff;\n} */\n/*下拉框*/\n.el-dropdown-menu {\n  background-color: #222832;\n  opacity: 0.9;\n  border-radius: 8px;\n  box-sizing: border-box;\n  padding: 0 20px;\n  border: 0;\n}\n.el-dropdown-menu__item {\n  color: #fff;\n  width: 140px;\n  line-height: 85px;\n  text-align: center;\n  border-bottom: 1px solid #737577;\n}\n.container-quality .hiddenRow {\n  display: none;\n}\n",{"version":3,"sources":["quality.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"quality.vue","sourceRoot":"src/components/index/quality","sourcesContent":["<!-- quality质量管理 -->\n<template>\n  <div class=\"container-quality\">\n    <!-- 头部 -->\n    <van-nav-bar title=\"质量管理\" @click-left=\"goBack\" fixed :border=\"false\" :z-index=\"100\">\n      <span class=\"el-icon-arrow-left fontsize\" slot=\"left\"></span>\n      <!-- <img src=\"../../../assets/imgs/screen.png\" class=\"screen fontsize\" slot=\"right\"> -->\n    </van-nav-bar>\n    <div class=\"wrapper\">\n      <!-- 搜索框 -->\n      <van-search\n        v-model=\"searchValue\"\n        placeholder=\"楼栋、专业、楼层、资源\"\n        show-action\n        shape=\"round\"\n        @keypress=\"GetQCSchedulePlan\"\n      >\n        <div slot=\"action\" @click=\"GetQCSchedulePlan\">搜索</div>\n      </van-search>\n      <!-- 隔层 -->\n      <div class=\"interlayer\"></div>\n      <!-- 表格 -->\n      <el-table :data=\"tableData\" style=\"width: 100%\" :row-class-name=\"rowClassNameHandler\" @row-click=\"clickRow\">\n        <el-table-column type=\"index\" align=\"left\" label=\"序号\" width=\"76\">\n          <template slot-scope=\"scope\">\n            <span :style=\"{marginLeft: scope.row.level * 5 + 'px'}\">\n              <span v-if=\"scope.row.showChildren\" @click.stop=\"onExpand(scope.row)\" :style=\"{cursor:scope.row.hasChildren ? 'pointer' : 'normal'}\">\n                {{scope.row.index}}\n              </span>\n              <span v-else @click.stop=\"onExpand(scope.row)\" :style=\"{cursor:scope.row.hasChildren ? 'pointer' : 'normal'}\">\n                {{scope.row.index}}\n              </span>\n            </span>\n            <!-- <span :data-level=\"scope.row.level\"></span> -->\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"TaskName\" align=\"center\">\n          <template slot=\"header\" slot-scope=\"scope\">\n            <span class=\"el-dropdown-link\">\n              任务名称\n            </span>\n            <!-- <el-dropdown trigger=\"click\">\n              <span class=\"el-dropdown-link\">\n                任务名称\n                <i class=\"el-icon-arrow-down\"></i>\n              </span>\n              <el-dropdown-menu slot=\"dropdown\">\n                <el-dropdown-item>整体模型</el-dropdown-item>\n                <el-dropdown-item>A1栋</el-dropdown-item>\n                <el-dropdown-item>A2栋</el-dropdown-item>\n                <el-dropdown-item>A3栋</el-dropdown-item>\n              </el-dropdown-menu>\n            </el-dropdown> -->\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"BaseFinishTime\" align=\"center\" :formatter=\"formatterTime\">\n          <template slot=\"header\" slot-scope=\"scope\">\n            <span class=\"el-dropdown-link\">\n              计划结束时间\n            </span>\n            <!-- <el-dropdown trigger=\"click\">\n              <span class=\"el-dropdown-link\">\n                计划结束时间\n                <i class=\"el-icon-arrow-down\"></i>\n              </span>\n              <el-dropdown-menu slot=\"dropdown\">\n                <el-dropdown-item>全部</el-dropdown-item>\n                <el-dropdown-item>建筑专业</el-dropdown-item>\n                <el-dropdown-item>结构专业</el-dropdown-item>\n                <el-dropdown-item>暖通专业</el-dropdown-item>\n                <el-dropdown-item>通风专业</el-dropdown-item>\n                <el-dropdown-item>弱电系统</el-dropdown-item>\n              </el-dropdown-menu>\n            </el-dropdown> -->\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"Duration\" align=\"center\" width=\"66\">\n          <template slot=\"header\" slot-scope=\"scope\">\n            <span class=\"el-dropdown-link\">\n              工期\n            </span>\n            <!-- <el-dropdown trigger=\"click\">\n              <span class=\"el-dropdown-link\">\n                工期\n                <i class=\"el-icon-arrow-down\"></i>\n              </span>\n              <el-dropdown-menu slot=\"dropdown\">\n                <el-dropdown-item>全部</el-dropdown-item>\n                <el-dropdown-item>建筑专业</el-dropdown-item>\n                <el-dropdown-item>结构专业</el-dropdown-item>\n                <el-dropdown-item>暖通专业</el-dropdown-item>\n                <el-dropdown-item>通风专业</el-dropdown-item>\n                <el-dropdown-item>弱电系统</el-dropdown-item>\n              </el-dropdown-menu>\n            </el-dropdown> -->\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n  </div>\n</template>\n\n<script type='textecmascript-6'>\nimport {GetQCSchedulePlan} from '@/api/api.js'\n\nexport default {\n  data() {\n    return {\n      active: 0, //tab默认位置\n      searchValue: \"\", //搜索值\n      tableData: [], //质量进度列表\n      userId:'', //用户id\n    };\n  },\n  mounted(){\n    this.userId = localStorage.getItem(\"userId\");\n    this.GetQCSchedulePlan()\n  },\n  computed: {\n    tableHeight(){\n      return (Number(document.documentElement.clientHeight) - 200) + 'px';\n    },\n  },\n  methods: {\n    onExpand(row) {\n      let self = this;\n\n      let isShowChildren = !row[\"showChildren\"];\n      row[\"showChildren\"] = isShowChildren;\n      self._loadAllSubItems(row, true, isShowChildren);\n    },\n\n    _loadAllSubItems(item, isFirstLevlChildren, isShowChilren) {\n      let self = this;\n      let dataArray = [];\n      for (let i = 0; i < self.tableData.length; i++) {\n        let tempItem = self.tableData[i];\n        if (tempItem.TaskParentId === item.TaskId) {\n          if (isFirstLevlChildren) {\n            tempItem[\"visible\"] = !tempItem[\"visible\"];\n          }\n          tempItem[\"hiddenByCategory\"] = !isShowChilren;\n\n          dataArray.push(tempItem);\n          let subItemArray = self._loadAllSubItems(\n            tempItem,\n            false,\n            isShowChilren\n          );\n          dataArray = dataArray.concat(subItemArray);\n        }\n      }\n      return dataArray;\n    },\n    GetQCSchedulePlan(){ //获取质量进度表数据\n\n      let params = {\n        ProjectID: localStorage.getItem(\"projectid\"),\n        Builing: '',\n        Specialty: '',\n        Floor: '',\n        CategoryName: '',\n        QueryInfo: this.searchValue\n      };\n      // console.log(params)\n      this.load();\n      this.Request(GetQCSchedulePlan(params)).then(res=>{\n        this.$toast.clear();\n        if(res.StatusCode===200){\n          if (res.Detiel.length != 0) {\n            let result = res.Detiel\n            let resultArray = this._processLevelStatisticData(result);\n            this.tableData = resultArray;\n          }else{\n            this.tableData = []\n          }\n        }else{\n         this.$message({type:'error',message:res.Message,center:'true'})\n        }\n      })\n    },\n    /**\n     * @name 遍历进度计划数据\n     */\n    _processLevelStatisticData(dataArray) {\n      let self = this;\n\n      let resultArray = []; // 一级栏目\n      let index = 1;\n      let level = 1;\n      for (let i = 0; i < dataArray.length; i++) {\n        let item = dataArray[i];\n        // 查找一级分类\n        if (!item.TaskParentId && typeof item.TaskParentId != \"undefined\") {\n          //item.TaskParentId === null\n          item[\"level\"] = level;\n          item[\"index\"] = index;\n          resultArray.push(item);\n          self._loadChildrenData(\n            resultArray,\n            dataArray,\n            item,\n            level + 1,\n            index++\n          );\n        }\n      }\n      return resultArray;\n    },\n    /**\n     * @name 递归输出子栏目\n     */\n    _loadChildrenData(resultArray, originArray, item, level, index) {\n      let self = this;\n\n      // let deployed = 0\n      // let undeployed = 0\n      // let edit = 0\n      // let completed = 0\n      let index2 = 1;\n\n      for (let i = 0; i < originArray.length; i++) {\n        let originItem = originArray[i];\n        // 判断是否是item项的子项\n        if (originItem.TaskParentId === item.TaskId) {\n          item[\"hasChildren\"] = true;\n          item[\"showChildren\"] = false;\n\n          originItem[\"index\"] = index + \".\" + index2;\n          originItem[\"level\"] = level;\n          originItem[\"visible\"] = false; // 子项默认隐藏\n          originItem[\"hiddenByCategory\"] = false;\n\n          resultArray.push(originItem);\n          self._loadChildrenData(\n            resultArray,\n            originArray,\n            originItem,\n            level + 1,\n            index + \".\" + index2++\n          );\n        }\n      }\n    },\n    rowClassNameHandler({ row, rowIndex }) {\n      let className = \"pid-\" + row.TaskParentId;\n      if (\n        row.TaskParentId !== null &&\n        (row[\"visible\"] !== true || row[\"hiddenByCategory\"] === true)\n      ) {\n        className += \" hiddenRow\";\n      }\n      return className;\n    },\n    /**\n     * 格式化日期\n     */\n    formatterTime(row, column) {\n      if (!row.BaseFinishTime) return \"\";\n      return row.BaseFinishTime.substring(0, row.BaseFinishTime.indexOf(\"T\"));\n    },\n    //点击表格行\n    clickRow(row) {\n      console.log('row',row.TaskId)\n      this.$router.push({ path: \"/ControlDetails\", query:{'TaskID': row.TaskId,'userid':this.userId }});\n    },\n    //返回\n    goBack() {\n      this.$router.push({ path: \"/nav/to/index\" });\n    }\n  }\n};\n</script>\n<style lang='stylus' scoped rel='stylesheet/stylus'>\n.container-quality\n  width 100%\n  height 100%\n  .van-nav-bar\n    height 88px\n    line-height 88px\n    border-bottom 1px solid #E5E5E5\n    .fontsize\n      font-size 42px\n      color #333\n      display inline-block\n      vertical-align middle\n    .screen\n      width 41px\n      height 35px\n  .wrapper\n    margin-top 88px\n    .interlayer\n      width 100%\n      height 21px\n</style>\n<style>\n/* 顶部表头 */\n.container-quality .van-nav-bar .van-nav-bar__title {\n  font-size: 36px;\n}\n/*tab切换栏*/\n.container-quality .van-tab span {\n  font-size: 30px;\n  line-height: 80px;\n}\n.container-quality .van-tabs--line .van-tabs__wrap {\n  height: 80px;\n}\n.container-quality .van-tabs--line .van-tabs__wrap {\n  color: #666;\n  position: fixed;\n  top: 88px !important;\n}\n.container-quality .van-tabs--line .van-tabs__wrap .van-tabs__nav {\n  background-color: #fff;\n}\n.container-quality .van-tab--active {\n  color: #5a92ff;\n}\n/* tab下边线 */\n.container-quality .van-hairline--top-bottom::after {\n  border-width: 0 0 2px 0;\n}\n.container-quality .van-tabs--line {\n  padding-top: 80px;\n}\n.container-quality .van-tabs__line {\n  height: 4px;\n  bottom: 19px;\n  width: 120px;\n  bottom: 21px;\n  background-color: #5a92ff;\n}\n/* .container-quality .van-tabs__content {\n  margin-top: 88px;\n} */\n/* 搜索栏 */\n.container-quality .van-search {\n  height: 98px;\n  padding: 17px 24px;\n}\n.container-quality .van-search .van-search__content {\n  height: 64px;\n  border-radius: 0;\n}\n.container-quality .van-search .van-search__content .van-cell {\n  line-height: 64px;\n  font-size: 28px;\n}\n.container-quality .van-search .van-search__content .van-cell .van-icon {\n  font-size: 40px;\n}\n.container-quality .van-search__action {\n  width: 120px;\n  line-height: 64px;\n  color: #fff;\n  font-size: 30px;\n  text-align: center;\n  background: rgba(88, 146, 255, 1);\n  border-radius: 8px;\n  margin-left: 18px;\n}\n/*表格*/\n.container-quality .el-table {\n  color: #333;\n  font-size: 24px;\n}\n.container-quality .el-table thead tr th {\n  background-color: #5892ff;\n  color: #fff;\n}\n.container-quality .el-table .cell {\n  line-height: 76px;\n}\n.container-quality .el-table th div {\n  vertical-align: middle;\n  color: #fff;\n}\n.el-dropdown-link{font-size: 24px;}\n/* .container-quality .el-icon--right {\n  width: 18px;\n  height: 9px;\n  display: inline-block;\n  background-image: url('../../../assets/imgs/bottom.png');\n  background-size: 100% 100%;\n  background-position: center;\n  background-color: #fff;\n} */\n/*下拉框*/\n.el-dropdown-menu {\n  background-color: #222832;\n  opacity: 0.9;\n  border-radius: 8px;\n  box-sizing: border-box;\n  padding: 0 20px;\n  border: 0;\n}\n.el-dropdown-menu__item {\n  color: #fff;\n  width: 140px;\n  line-height: 85px;\n  text-align: center;\n  border-bottom: 1px solid #737577;\n}\n.container-quality .hiddenRow {\n  display: none;\n}\n</style>\n"]}]}