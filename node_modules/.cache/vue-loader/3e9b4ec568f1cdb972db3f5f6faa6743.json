{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\AI-report\\custom-report.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\AI-report\\custom-report.vue","mtime":1557717670468},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\css-loader\\index.js","mtime":1552270042900},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1552270044128},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1552270043529},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.list-content{\r\n        margin-top:46px;\r\n        overflow:scroll;\r\n    }\r\n    .list-item{\r\n        text-align:center;\r\n    }\r\n/* 顶部表头 */\r\n.container-ai-report .van-nav-bar .van-nav-bar__title {\r\n    font-size: 36px;\r\n    font-weight: 400;\r\n}\r\n.container-ai-report  .van-nav-bar {\r\n    height: 88px;\r\n    line-height: 88px;\r\n }\r\n/* 自定义表单列表 */\r\n.custom-report-list{width: 100%;height: auto;margin-top: 100px;}\r\n.custom-report-list ul{height: auto;border-top: 1px solid #e9e9e9;background: #fff;padding: 0 20px;}\r\n.custom-report-list ul li{width: 100%;height: 80px;line-height: 80px;padding: 4px 0; border-bottom: 1px solid #e9e9e9;font-size: 26px;}\r\n.custom-report-list ul li span{color: #323233;}\r\n.custom-report-list-span{float: left;}\r\n.custom-report-list-input{float: right;width: 80%;height: 80px;line-height: 80px; text-align: right;}\r\n.custom-report-list ul li .van-cell{padding: 0;height: 80px;line-height: 80px;font-size: 26px;}\r\n.custom-report-list ul li .van-cell .van-cell__right-icon{padding-top: 30px;font-size: 30px;}\r\n.van-picker__toolbar{height: 60px;line-height: 60px;}\r\n.van-picker__toolbar .van-picker__cancel,.van-picker__toolbar .van-picker__confirm{font-size: 26px;}\r\n.custom-report-tag{padding:0 20px;}\r\n.custom-report-tag p{width: 100%;height: 80px;line-height: 80px;font-size: 26px;color: #323233;}\r\n.custom-report-tag-list{width: 90%; display: flex;flex-wrap: wrap}\r\n.custom-report-tag-list span{display: inline-block;text-align: center; width: 136px;height: 47px;line-height: 47px; border:1px solid #5a92ff;border-radius: 10px;font-size: 26px;color: #5a92ff;margin:0 20px 20px 0;}\r\n.custom-report-bt{width: 94%;margin: 40px auto 0;display: block;border: none;border-radius: 20px;height: 80px;font-size: 28px;background: #5a92ff;color: #fff;}\r\n.content-class .van-cell__value span{width: 100%;display: inline-block;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}\r\n.content-class-popup .van-cell{font-size: 26px;padding: 20px;}\r\n",{"version":3,"sources":["custom-report.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"custom-report.vue","sourceRoot":"src/components/AI-report","sourcesContent":["<!-- custom-report自定义报表 -->\r\n<template>\r\n <div class='container-ai-report'>\r\n    <!-- 返回键+自定义报表 -->\r\n    <van-nav-bar title=\"自定义报表\" @click-left=\"goBack\"  fixed :border=\"true\" :z-index=\"100\" >\r\n        <span class=\"el-icon-arrow-left fontsize\" slot=\"left\"></span>\r\n    </van-nav-bar>\r\n    <!-- 自定义列表 -->\r\n    <div class=\"custom-report-list\">\r\n      <ul>\r\n        <li>\r\n          <span class=\"custom-report-list-span\">资料名称：</span>\r\n          <input type=\"text\" class=\"custom-report-list-input\" v-model=\"dataName\" placeholder=\"请输入名称\">\r\n        </li>\r\n        <li class=\"content-class\">\r\n          <van-cell title=\"内容配置：\" :value=\"contentConfiguration\" @click=\"showContentConfiguration = true\" is-link/>\r\n        </li>\r\n        <li>\r\n          <van-cell title=\"楼栋：\" :value=\"storiedBuilding\" @click=\"showStoriedBuilding = true\" is-link/>\r\n        </li>\r\n        <li>\r\n          <van-cell title=\"楼层：\" :value=\"floor\" @click=\"isShowFloor\" is-link/>\r\n        </li>\r\n        <li>\r\n          <van-cell title=\"开始时间：\" :value=\"startTime\" @click=\"showStartTime = true\" readonly=\"readonly\" is-link/>\r\n        </li>\r\n        <li>\r\n          <van-cell title=\"结束时间：\" :value=\"endTime\" @click=\"showEndTime = true\" readonly=\"readonly\" is-link/>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <!-- 标签 -->\r\n    <div class=\"custom-report-tag\">\r\n      <p>标签：</p>\r\n      <div class=\"custom-report-tag-list\">\r\n        <span v-for=\"(span,index) in defaultMarkList\" :key=\"index+1\" @click=\"setRemarkData(span)\">{{span.LabelName}}</span>\r\n        <span v-for=\"(span,index) in markList\" :key=\"index\" @click=\"setRemarkData(span)\">{{span.LabelName}}</span>\r\n      </div>\r\n    </div>\r\n    <!-- 确定检索 -->\r\n    <van-button size=\"large\" class=\"custom-report-bt\" @click=\"submitRetrieval\">确认检索</van-button>\r\n    <div>\r\n        <van-nav-bar\r\n                fixed\r\n                title=\"数据列表\"\r\n                right-text=\"退出登录\"\r\n        />\r\n        <div class=\"list-content\" id=\"list-content\">\r\n            <van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\r\n                <van-list\r\n                    v-model=\"loading\"\r\n                    :finished=\"finished\"\r\n                    @load=\"onLoad\"\r\n                    :offset=\"10\"\r\n                >\r\n \r\n                </van-list>\r\n            </van-pull-refresh>\r\n        </div>\r\n \r\n    </div>\r\n    <!-- 内容配置弹窗 -->\r\n    <van-popup v-model=\"showContentConfiguration\" position=\"bottom\">\r\n      <van-checkbox-group v-model=\"resultContent\" class=\"content-class-popup\">\r\n        <van-cell-group>\r\n          <van-cell\r\n            v-for=\"(item, index) in contentConfigurationList\"\r\n            clickable\r\n            :key=\"index+1\"\r\n            :title=\"item.text\"\r\n            @click=\"toggle(index,item)\"\r\n          >\r\n          <van-checkbox :name=\"item.id\" ref=\"checkboxes\" />\r\n          </van-cell>\r\n        </van-cell-group>\r\n      </van-checkbox-group>\r\n      <!-- <van-picker\r\n        show-toolbar\r\n        :columns=\"contentConfigurationList\"\r\n        @confirm=\"confirmContentConfiguration\"\r\n        @cancel=\"showContentConfiguration = false\"\r\n      /> -->\r\n    </van-popup>\r\n    <!-- 楼栋弹窗 -->\r\n    <van-popup v-model=\"showStoriedBuilding\" position=\"bottom\">\r\n      <van-picker\r\n        show-toolbar\r\n        :columns=\"storiedBuildingList\"\r\n        @confirm=\"confirmStoriedBuilding\"\r\n        @cancel=\"showStoriedBuilding = false\"\r\n      />\r\n    </van-popup>\r\n    <!-- 楼层弹窗 -->\r\n    <van-popup v-model=\"showFloor\" position=\"bottom\">\r\n      <van-picker\r\n        show-toolbar\r\n        :columns=\"floorList\"\r\n        @confirm=\"confirmFloor\"\r\n        @cancel=\"showFloor = false\"\r\n      />\r\n    </van-popup>\r\n    <!-- 开始时间 -->\r\n    <van-popup v-model=\"showStartTime\" position=\"bottom\" :overlay=\"true\">\r\n      <van-datetime-picker\r\n        type=\"date\"\r\n        v-model=\"currentDate\"\r\n        @confirm=\"confirmStartTime\"\r\n        @cancel=\"showStartTime = false\"\r\n        @change=\"startTimeChange\"\r\n      />\r\n    </van-popup>\r\n    <!-- 结束时间 -->\r\n    <van-popup v-model=\"showEndTime\" position=\"bottom\" :overlay=\"true\">\r\n      <van-datetime-picker\r\n        type=\"date\"\r\n        v-model=\"currentDate\"\r\n        @confirm=\"confirmEndTime\"\r\n        @cancel=\"showEndTime = false\"\r\n        @change=\"endTimeChange\"\r\n      />\r\n    </van-popup>\r\n </div>\r\n</template>\r\n<script type='textecmascript-6'>\r\nimport { AIReportTypeList,GetBuilding,GetFloorbyBuilding,GetReportLabelList,GetCustomFormExport } from '@/api/api.js'\r\n\r\nexport default{\r\n  data(){\r\n    return{\r\n      resultContent: [],\r\n      dataName:'', //资料名称\r\n      contentConfiguration:'', //内容配置\r\n      showContentConfiguration:false, //显示内容配置弹窗\r\n      contentConfigurationList: [], //内容配置列表\r\n      storiedBuilding:'全部', //楼栋\r\n      showStoriedBuilding:false, //显示楼栋弹窗\r\n      storiedBuildingList: [], //楼栋列表\r\n      floor:'全部', //楼层\r\n      showFloor:false, //显示楼层弹窗\r\n      floorList: [], //楼层列表\r\n      currentDate: new Date(),\r\n      startTime:require('moment')().format('YYYY-MM-DD'), //开始时间\r\n      showStartTime:false, //显示开始时间\r\n      startTimeBox:'', //开始时间容器\r\n      endTime:require('moment')().format('YYYY-MM-DD'), //结束时间\r\n      showEndTime:false, //显示结束时间\r\n      endTimeBox:'', //结束时间容器\r\n      ProjectID: localStorage.getItem('projectid'),\r\n      defaultMarkList: [\r\n        {ID:1,LabelName:\"质量管理\",LabelValue:\"8\"},\r\n        {ID:2,LabelName:\"安全管理\",LabelValue:\"9\"},\r\n        {ID:3,LabelName:\"三算对比\",LabelValue:\"10\"}\r\n      ], // 默认标签列表\r\n      markList:[], //动态标签列表\r\n    }\r\n  },\r\n  mounted(){\r\n    this.ProjectID = localStorage.getItem('projectid')\r\n    this.AIReportTypeList() //获取内容配置下拉\r\n    this.GetBuilding()\r\n    this.GetReportLabelList()\r\n  },\r\n  methods:{\r\n    AIReportTypeList(){ //获取内容配置下拉\r\n      this.load();\r\n      this.Request(AIReportTypeList({})).then(res=>{\r\n        // console.log('获取内容配置下拉',res)\r\n        this.$toast.clear();\r\n        if(res.StatusCode=='200'){\r\n          this.contentConfigurationList = res.Detiel\r\n        }else{\r\n          this.$message({type:\"error\",message:res.Message,center:\"true\"});\r\n        }\r\n      })\r\n    },\r\n    async GetBuilding(){ //获取项目的楼栋信息\r\n      this.load();\r\n      let res = await this.Request(GetBuilding({projectid: this.ProjectID}))\r\n      // console.log('获取项目的楼栋信息',res)\r\n      this.$toast.clear();\r\n      if(res.StatusCode=='200'){\r\n        // 是否含有全部\r\n        if(res.Detiel[0].text.indexOf('全部') > 0){\r\n          this.storiedBuildingList = res.Detiel\r\n        }else{\r\n          let DetielAll = [{id: \"全部\", text: \"全部\"}]\r\n          for(let item of res.Detiel){\r\n            DetielAll.push(item)\r\n          }\r\n          this.storiedBuildingList = DetielAll\r\n        }\r\n      }else{\r\n        this.$message({type:\"error\",message:res.Message,center:\"true\"});\r\n      }\r\n    },\r\n    GetFloorbyBuilding(){ //根据楼栋获取楼层\r\n      let params = {\r\n        projectid: this.ProjectID,\r\n        building: this.storiedBuilding\r\n      }\r\n      this.load();\r\n      this.Request(GetFloorbyBuilding(params)).then(res=>{\r\n        this.$toast.clear();\r\n        // console.log('根据楼栋获取楼层',res)\r\n        if(res.StatusCode=='200'){\r\n          if(res.Detiel.length != 0){ //优化当楼栋选择全部\r\n            if(res.Detiel[0].text.indexOf('全部') > 0){\r\n              this.floorList = res.Detiel\r\n            }else{\r\n              let DetielAll = [{id: \"全部\", text: \"全部\"}]\r\n              for(let item of res.Detiel){\r\n                DetielAll.push(item)\r\n              }\r\n              this.floorList = DetielAll\r\n            }\r\n          }\r\n        }else{\r\n          this.$message({type:\"error\",message:res.Message,center:\"true\"});\r\n        }\r\n      })\r\n    },\r\n    async GetReportLabelList(){ //获取标签列表接口\r\n      this.load();\r\n      let res = await this.Request(GetReportLabelList({}))\r\n      // console.log('获取标签列表接口',res)\r\n      this.$toast.clear();\r\n      if(res.StatusCode=='200'){\r\n        this.markList = res.Detiel\r\n      }else{\r\n        this.$message({type:\"error\",message:res.Message,center:\"true\"});\r\n      }\r\n    },\r\n    confirmStoriedBuilding(value,index){ //确定楼栋\r\n      console.log(value)\r\n      this.storiedBuilding = value.text\r\n      this.showStoriedBuilding = false\r\n      this.GetFloorbyBuilding()\r\n    },\r\n    isShowFloor(){ //选择楼层\r\n      if(this.storiedBuilding == '全部'){\r\n        this.$message({type:\"warning\",message:'请先选择楼栋',center:\"true\"});\r\n      }else{\r\n        this.showFloor = true\r\n      }\r\n    },\r\n    confirmFloor(value,index){ //确定楼层\r\n      this.floor = value.text\r\n      this.showFloor = false\r\n    },\r\n    confirmStartTime(type, value){ //确定开始时间\r\n      this.startTime = this.formatterTime(this.startTimeBox)\r\n      this.showStartTime = false\r\n    },\r\n    confirmEndTime(){ //确定结束时间\r\n      this.endTime = this.formatterTime(this.endTimeBox)\r\n      this.showEndTime = false\r\n    },\r\n    startTimeChange(e){ //当值变化时触发的事件\r\n      let endTimeArr = e.getValues();\r\n      this.startTimeBox = `${endTimeArr[0]}-${endTimeArr[1]}-${endTimeArr[2]}  ${endTimeArr[3]}:${endTimeArr[4]}:00`\r\n    },\r\n    endTimeChange(e){ //当值变化时触发的事件\r\n      let endTimeArr = e.getValues();\r\n      this.endTimeBox = `${endTimeArr[0]}-${endTimeArr[1]}-${endTimeArr[2]}  ${endTimeArr[3]}:${endTimeArr[4]}:00`\r\n    },\r\n    // 默认设置标签数据\r\n    setRemarkData(val){\r\n      if(val){\r\n        console.log(val)\r\n        this.dataName = val.LabelName\r\n        this.resultContent = []\r\n        this.resultContent.push(val.LabelValue)\r\n      }\r\n    },\r\n    submitRetrieval(){ //确定检索\r\n      if(!this.dataName){\r\n        this.$message({type:\"warning\",message:'请输入资料名称',center:\"true\"});\r\n        return\r\n      }\r\n      if(this.resultContent == ''){\r\n        this.$message({type:\"warning\",message:'请选择内容配置',center:\"true\"});\r\n        return\r\n      }\r\n      let params = {\r\n        ProjectID:this.ProjectID,\r\n        ReportName: this.dataName,\r\n        AIReportType: this.resultContent,\r\n        BuildingName: this.storiedBuilding,\r\n        LevelName: this.floor,\r\n        StartTime: this.startTime,\r\n        EndTime: this.endTime,\r\n      }\r\n      // console.log(params)\r\n      this.load();\r\n      this.Request(GetCustomFormExport(params)).then(res=>{\r\n        this.$toast.clear();\r\n        // console.log('自定义表格导出',res)\r\n        if(res.StatusCode=='200'){\r\n          this.$message({type:'success',message:res.Message,center:'true'})\r\n          this.$router.push({path:'nav/index/AI-report',query:{'active':4}})\r\n        }else{\r\n          this.$message({type:\"error\",message:res.Message,center:\"true\"});\r\n        }\r\n      })\r\n      \r\n    },\r\n    //返回\r\n    goBack() {\r\n      this.$router.back(-1)\r\n    },\r\n    /**\r\n     * 格式化日期\r\n     */\r\n    formatterTime(time) {\r\n      if (!time) return \"\";\r\n      return time.substring(0, time.indexOf(\"u\"));\r\n    },\r\n    toggle(index,item) { //复选框\r\n      this.$refs.checkboxes[index].toggle();\r\n      let contentVal = ''\r\n      for(let item of this.resultContent){ // 返现对应的文字\r\n        contentVal += this.contentConfigurationList[item].text\r\n      }\r\n      this.contentConfiguration = contentVal\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n.list-content{\r\n        margin-top:46px;\r\n        overflow:scroll;\r\n    }\r\n    .list-item{\r\n        text-align:center;\r\n    }\r\n/* 顶部表头 */\r\n.container-ai-report .van-nav-bar .van-nav-bar__title {\r\n    font-size: 36px;\r\n    font-weight: 400;\r\n}\r\n.container-ai-report  .van-nav-bar {\r\n    height: 88px;\r\n    line-height: 88px;\r\n }\r\n/* 自定义表单列表 */\r\n.custom-report-list{width: 100%;height: auto;margin-top: 100px;}\r\n.custom-report-list ul{height: auto;border-top: 1px solid #e9e9e9;background: #fff;padding: 0 20px;}\r\n.custom-report-list ul li{width: 100%;height: 80px;line-height: 80px;padding: 4px 0; border-bottom: 1px solid #e9e9e9;font-size: 26px;}\r\n.custom-report-list ul li span{color: #323233;}\r\n.custom-report-list-span{float: left;}\r\n.custom-report-list-input{float: right;width: 80%;height: 80px;line-height: 80px; text-align: right;}\r\n.custom-report-list ul li .van-cell{padding: 0;height: 80px;line-height: 80px;font-size: 26px;}\r\n.custom-report-list ul li .van-cell .van-cell__right-icon{padding-top: 30px;font-size: 30px;}\r\n.van-picker__toolbar{height: 60px;line-height: 60px;}\r\n.van-picker__toolbar .van-picker__cancel,.van-picker__toolbar .van-picker__confirm{font-size: 26px;}\r\n.custom-report-tag{padding:0 20px;}\r\n.custom-report-tag p{width: 100%;height: 80px;line-height: 80px;font-size: 26px;color: #323233;}\r\n.custom-report-tag-list{width: 90%; display: flex;flex-wrap: wrap}\r\n.custom-report-tag-list span{display: inline-block;text-align: center; width: 136px;height: 47px;line-height: 47px; border:1px solid #5a92ff;border-radius: 10px;font-size: 26px;color: #5a92ff;margin:0 20px 20px 0;}\r\n.custom-report-bt{width: 94%;margin: 40px auto 0;display: block;border: none;border-radius: 20px;height: 80px;font-size: 28px;background: #5a92ff;color: #fff;}\r\n.content-class .van-cell__value span{width: 100%;display: inline-block;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}\r\n.content-class-popup .van-cell{font-size: 26px;padding: 20px;}\r\n</style>"]}]}