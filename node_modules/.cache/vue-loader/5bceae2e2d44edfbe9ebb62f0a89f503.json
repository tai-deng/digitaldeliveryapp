{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\user\\communicateDetail.vue?vue&type=style&index=0&id=1280c2b0&lang=stylus&scoped=true&rel=stylesheet%2Fstylus&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\user\\communicateDetail.vue","mtime":1557998374653},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\css-loader\\index.js","mtime":1552270042900},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1552270044128},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1552270043529},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\stylus-loader\\index.js","mtime":1552270053417},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.communicate_detail\r\n  width 100%\r\n  height 100%\r\n",{"version":3,"sources":["communicateDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsTA;AACA;AACA","file":"communicateDetail.vue","sourceRoot":"src/components/user","sourcesContent":["<!-- communicate_detail 沟通管理 -->\r\n<template>\r\n <div class='communicate_detail' >\r\n    <div class='wrapper' id=\"hum_wrapper\">\r\n        <!-- 头部 -->\r\n        <div class=\"header\">\r\n            <van-nav-bar\r\n                title=\"沟通管理\"\r\n                left-arrow\r\n                @click-left=\"onClickLeft\"\r\n            >\r\n            <!-- <div class=\"nav_right\" slot=\"right\"> <img src=\"../../assets/imgs/screen.png\" alt=\"\" /> </div> -->\r\n            </van-nav-bar>\r\n        </div>\r\n        <van-tabs v-model=\"active\" :line-width=\"88\" sticky color=\"#5A92FF\" @change=\"handleIndex\">\r\n          <van-tab v-for=\"item in titleArr\" :key=\"item.value\" :title=\"item.label\">\r\n             <!-- 隔层 -->\r\n            <div class=\"interlayer\"></div>\r\n\r\n            <div class=\"content\">\r\n                  <!-- 沟通管理列表 -->\r\n              <div class=\"communicate_content\">\r\n                  <el-table\r\n                      :header-row-style = \"{'background-color': '#5A92FF', 'color': '#fff','height': '40px'}\">\r\n                      <el-table-column\r\n                          prop=\"type\"\r\n                          label=\"类型\"\r\n                          width=\"80\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"themeContent\"\r\n                          label=\"主题\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"createTime\"\r\n                          label=\"发起时间\"\r\n                          width=\"110\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"state\"\r\n                          label=\"状态\"\r\n                          width=\"60\">\r\n                      </el-table-column>\r\n                  </el-table>\r\n              </div>             \r\n              <div :ref=\"`scrollBox${item.value}`\" class=\"com_content_list\">\r\n                  <el-table\r\n                  v-loading=\"ingLoading\"\r\n                  :data=\"tableData\"\r\n                  :show-header=\"false\"\r\n                  @row-click=\"goToDetail\">\r\n                      <el-table-column\r\n                          prop=\"ComType\"\r\n                          label=\"类型\"\r\n                          width=\"80\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"Subject\"\r\n                          label=\"主题\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"dCreateTime\"\r\n                          label=\"发起时间\"\r\n                          width=\"110\">\r\n                      </el-table-column>\r\n                          <el-table-column\r\n                          prop=\"Status\"\r\n                          label=\"状态\"\r\n                          width=\"60\">\r\n                      </el-table-column>\r\n                  </el-table>\r\n                  <div v-loading=\"scrollLoader\" class=\"loader\" :style=\"{width: screenWidth+'px'}\"></div>\r\n              </div>\r\n            </div>\r\n          </van-tab>\r\n        </van-tabs>\r\n    </div>\r\n </div>\r\n</template>\r\n\r\n<script type='textecmascript-6'>\r\nimport{GetCommunicateList,\r\n} from '@/api/api.js'\r\nexport default {\r\n data() {\r\n   return {\r\n    projectid: localStorage.getItem('projectid'),  \r\n    pageIndex: 1,\r\n    pageSize: 15,\r\n    sel_show: false,\r\n    active: 0,\r\n    dataHandle: [], // 进行中\r\n    dataOver: [],   //已完成\r\n    activeNames: ['0'],\r\n    titleArr: [\r\n      { value: 0, label: \"整改中（0条）\" },\r\n      { value: 1, label: \"待接收（0条）\" },\r\n      { value: 2, label: \"已整改（0条）\" }\r\n    ],\r\n    tableData: [],\r\n    // 人力物资列表数据\r\n    dataIng: [],\r\n    ingPageTotal: 0,\r\n    handlePageTotal: 0,\r\n    overPageTotal: 0,\r\n    statusList: ['', '0','1','2'], //状态为空字符串时查询全部， 0： 待接收 1： 处理中 2： 已处理\r\n    ingLoading: false,   //待接收状态\r\n    handleLoading: false, // 进行中状态\r\n    overLoading: false, // 已完成状态\r\n    scrollLoader: false, //上啦加载\r\n    screenWidth: 0  // 屏幕宽\r\n    }\r\n    },\r\n    created(){\r\n        this.screenWidth = window.screen.width;\r\n        this.getcommunicating(this.statusList[1])\r\n        this.getcommunicating(this.statusList[2])\r\n        this.getcommunicating(this.statusList[3])\r\n    },\r\n    updated(){\r\n      this.scrcllFun()\r\n    },\r\n    methods: {\r\n         // 返回按钮\r\n        onClickLeft() {\r\n        this.$router.go(-1)\r\n        },\r\n\r\n        // 重置函数 \r\n        resetFunc() {\r\n        console.log(\"chongzhi\")\r\n        this.sel_show = false;\r\n        },\r\n        //确认函数 \r\n        recordCheck() {\r\n        console.log('queren')\r\n        this.sel_show = false;\r\n\r\n        },\r\n        // 表格合并单元格\r\n        arraySpanMethod({ columnIndex }) {\r\n        \r\n            if (columnIndex === 5) {\r\n                return [6, 1];\r\n            } else if (columnIndex === 4) {\r\n                return [6, 1];\r\n            }\r\n            },\r\n        // 跳转至详情\r\n        goToDetail(row, event, column) {\r\n        console.log(row)\r\n        console.log(event)\r\n        console.log(column)\r\n        this.$router.push({\r\n            path: \"talking\",\r\n            query: {\r\n            id: row.ID,\r\n            }\r\n        });\r\n        },\r\n        //切换栏函数\r\n        handleIndex( index, title){\r\n          console.log(index)\r\n          console.log(title)\r\n          if(index === 0){\r\n            this.tableData = this.dataHandle\r\n          } else if(index === 1){\r\n            this.tableData = this.dataIng\r\n          } else if(index === 2){\r\n            this.tableData = this.dataOver\r\n          }\r\n          \r\n        },\r\n        // 下拉加载更多\r\n        scrcllFun(){\r\n          let that = this\r\n          console.log(this.$refs[`scrollBox${this.active}`])\r\n          let scrollEl = this.$refs[`scrollBox${this.active}`][0]\r\n          scrollEl.onscroll = function(){\r\n            let scrollH = scrollEl.scrollHeight;\r\n            let scrollT = scrollEl.scrollTop\r\n            let screenH = window.screen.height;\r\n            let rel = scrollT /(scrollH + 141 - screenH )\r\n            console.log(scrollT)\r\n            if(rel>=1&& !that.scrollLoader){\r\n              that.scrollLoader = true\r\n              if(that.active === 0){\r\n                if(that.handlePageTotal > that.tableData.length){\r\n                  that.pageSize += that.pageSize\r\n                  that.CommunicateList(that.active)\r\n                }else {\r\n                  that.$toast({\r\n                    message: '没有更多数据了',\r\n                    duration: 800\r\n                  })\r\n                  that.scrollLoader = false\r\n                }\r\n                \r\n              } else if(that.active === 1){\r\n                if(that.ingPageTotal > that.tableData.length){\r\n                  that.pageSize += that.pageSize\r\n                  that.CommunicateList(that.active)\r\n                }else {\r\n                  that.$toast({\r\n                    message: '没有更多数据了',\r\n                    duration: 800\r\n                  })\r\n                  that.scrollLoader = false\r\n                }\r\n\r\n              } else if(that.active === 2){\r\n                if(that.overPageTotal > that.tableData.length){\r\n                  that.pageSize += that.pageSize\r\n                  that.CommunicateList(that.active)\r\n                }else {\r\n                  that.$toast({\r\n                    message: '没有更多数据了',\r\n                    duration: 800\r\n                  })\r\n                  that.scrollLoader = false\r\n                }\r\n\r\n              }\r\n            }\r\n          }\r\n          \r\n        },\r\n        /**\r\n         * 根据项目ID和状态获取沟通管理问题列表\r\n         */  \r\n        getcommunicating(state){\r\n        if(state === '0') {\r\n            this.ingLoading = true;\r\n        }else if(state === '1'){\r\n            this.handleLoading = true\r\n        } else if(state === '2'){\r\n            this.overLoading = true\r\n        } else if(state === ''){\r\n            this.allLoading = true\r\n        } else {\r\n            return false\r\n        }\r\n        this.CommunicateList(state)\r\n        },\r\n        /**\r\n         * api接口\r\n         */\r\n         // 根据项目ID获取沟通管理列表\r\n        async CommunicateList (state){\r\n        // this.load()\r\n        let data = {\r\n            projectId: this.projectid,\r\n            status: state,\r\n            pageIndex: this.pageIndex,\r\n            pageSize: this.pageSize\r\n        }\r\n\r\n        let res = await this.Request(GetCommunicateList(data))\r\n        console.log('沟通管理......')\r\n        console.log(res)\r\n        if(res.StatusCode === 200) {\r\n            let newData = []\r\n            let tData = {}\r\n            res.Detiel.forEach((item, i) => {\r\n                tData = Object.assign({index: `${i+1}`},item.Communicate)\r\n                tData.dCreateTime = item.Communicate.dCreateTime.substr(0, 10)\r\n                tData.Status = `${item.Communicate.DoNum}/${item.Communicate.TotalDoNum}`\r\n                newData.push(tData)\r\n            })\r\n        \r\n            if(data.status === '0'){ \r\n            this.dataIng = newData\r\n            this.ingPageTotal = parseInt(res.Count)\r\n            this.titleArr[1].label = `待接收（${parseInt(res.Count)}条）`\r\n            this.ingLoading = false\r\n            console.log(this.dataIng)\r\n        \r\n            }else if(data.status === '1'){\r\n            this.dataHandle = newData\r\n            this.handlePageTotal = parseInt(res.Count)\r\n            this.titleArr[0].label = `整改中（${parseInt(res.Count)}条）`\r\n            if(this.active === 0){\r\n              this.tableData = this.dataHandle\r\n            }\r\n            this.handleLoading = false\r\n            console.log(this.dataHandle)\r\n            } else if( data.status === '2'){\r\n            this.dataOver = newData\r\n            this.overLoading = false \r\n            this.overPageTotal = parseInt(res.Count)\r\n            this.titleArr[2].label = `已整改（${parseInt(res.Count)}条）`\r\n            console.log(this.dataOver)\r\n            }\r\n            this.scrollLoader = false\r\n            \r\n        }else {\r\n            this.$message({\r\n            type: 'error',\r\n            message: res.Message,\r\n            center: 'true'\r\n            })\r\n        }\r\n        // this.$toast.clear()\r\n        },\r\n    }\r\n    \r\n}\r\n\r\n</script>\r\n<style lang='stylus' scoped rel='stylesheet/stylus'>\r\n.communicate_detail\r\n  width 100%\r\n  height 100%\r\n</style>\r\n<style lang=\"stylus\" rel='stylesheet/stylus'>\r\n@import '../../assets/stylus/variable'\r\n  #hum_wrapper {\r\n    // overflow-x: scroll;\r\n    width: 100%;\r\n    height: 100%;\r\n    //头部样式\r\n    .header {\r\n    // position: fixed;\r\n    // top: 0px;\r\n    // left: 0px;\r\n    width: 100%;\r\n    \r\n    z-index: 30;\r\n    }\r\n    .van-tabs--line {\r\n      padding-top: 88px;\r\n      height: calc(100% - 88px)\r\n      box-sizing: border-box;\r\n      .van-tabs__content {\r\n        height: 100%\r\n        overflow-x: auto;\r\n        .van-tab__pane {\r\n          height: 100%;\r\n        }\r\n      }\r\n    }\r\n    .interlayer {\r\n      width 100%\r\n      height 26px\r\n      background-color #F6F8FA\r\n    }\r\n   \r\n    .van-tabs__wrap {\r\n      height: 88px;\r\n      .van-ellipsis {\r\n        display: inline-block;\r\n        height: 88px;\r\n        line-height: 88px;\r\n        font-size:28px;\r\n        font-family:PingFang-SC-Bold;\r\n        font-weight:bold;\r\n        box-sizing: border-box;\r\n        color: #666;\r\n      }\r\n      .van-tab--active .van-ellipsis {\r\n        color: #5A92FF;\r\n      }\r\n    }\r\n    .content {\r\n        // position:fixed;\r\n        // top: 88px;\r\n        // left: 0px;\r\n        // margin-top: 88px;\r\n        width: 100%;\r\n        height: calc(100% - 26px)\r\n        box-sizing: border-box;\r\n        overflow-x: auto;\r\n    }\r\n    .van-nav-bar {\r\n      width: 100%;  \r\n      height: 88px;\r\n      border-bottom: 1px solid #E5E5E5;\r\n      box-sizing: border-box;\r\n\r\n      .van-nav-bar__title,\r\n      .van-nav-bar__left,\r\n      .van-nav-bar__right {\r\n        color: #000;\r\n        height: 88px;\r\n        // // padding-top: 41px;\r\n        line-height: 88px;\r\n        font-size $font-size-title;\r\n        box-sizing: border-box;\r\n        z-index 100;\r\n      }\r\n      .van-icon-arrow-left {\r\n        color: #000 ;\r\n        font-size $font-size-title;\r\n      }\r\n      .van-nav-bar__text {\r\n        color: #000;\r\n        font-size $font-size-title;\r\n      }\r\n      // .nav_right {\r\n      //   img {\r\n      //       width: 41px;\r\n      //     height 35px;\r\n          \r\n      //   }\r\n      // }\r\n    }\r\n    // 沟通管理列表样式 \r\n    .communicate_content {\r\n        // position: absolute;\r\n        // top: 0px;\r\n        // left: 0px;\r\n        width: 908px;\r\n        z-index: 30;\r\n        .el-table__body-wrapper {\r\n            display: none;\r\n        }  \r\n    }\r\n    \r\n    .com_content_list {\r\n      overflow-y:auto;\r\n      overflow-x: hidden;\r\n      // padding-top: 80px;\r\n      width: 908px;\r\n      height: calc(100% - 80px)\r\n      .loader {\r\n        position: fixed!important;\r\n        left: 0px;\r\n        bottom: 0px;\r\n        height: 88px;\r\n      }\r\n    }\r\n    .el-table {\r\n        .cell {\r\n            line-height 60px\r\n        }\r\n      .el-table__header-wrapper {\r\n        tr {\r\n          th {\r\n            background-color: #5A92FF\r\n            padding: 0px!important;\r\n            .cell {\r\n                height 100%;\r\n                line-height 60px;\r\n                text-align: center;\r\n                font-size: 30px;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .el-table__body-wrapper {\r\n        tr {\r\n            height 80px;\r\n          td {\r\n            height 80px;\r\n            font-size: 28px;\r\n            text-align: center;\r\n            color: #333;\r\n          }\r\n        }\r\n         //左上角图标样\r\n\r\n        tr:nth-child(2n+1):after {\r\n        // display: inline-block;\r\n        // content: '滞';\r\n        // font-size: 20px;\r\n        // padding 10px 0 0 10px;\r\n        // width: 60px\r\n        // height: 60px;\r\n        // color: #fff;\r\n        // background url('../../assets/imgs/mark.png') center center no-repeat;\r\n        // transform: translate(-1134%, 0)\r\n        }\r\n      }\r\n    }\r\n\r\n    // 筛选样式\r\n     .select_layer {\r\n      position: fixed;\r\n      top: 126px;\r\n      right: 24px;\r\n      width 352px;\r\n      box-sizing: border-box;\r\n      background:rgba(34,40,50,1)\r\n      border-radius:8px\r\n      padding 10px 20px;\r\n      z-index: 999\r\n        .van-hairline--top-bottom::after{\r\n          border: none;\r\n        }\r\n        .van-hairline--top::after {\r\n          border-top: none;\r\n          border-bottom: 1px solid #737577;\r\n        }\r\n        .van-collapse  {\r\n          max-height 909px;\r\n        }\r\n        .van-collapse-item{\r\n          .van-collapse-item__title--expanded::after {\r\n            visibility hidden\r\n          }\r\n        }\r\n        .van-collapse-item:first-child {\r\n          border-bottom: 1px solid #737577;\r\n        }\r\n        .van-collapse-item__title {\r\n          height 86px;\r\n          line-height 86px;\r\n          height 86px;\r\n         \r\n          background-color $color-bgc-2;\r\n         \r\n          .van-cell__title{\r\n            font-size 30px;\r\n            color #fff;\r\n            text-align left;         \r\n          }\r\n          .van-cell__right-icon {\r\n            color: transparent;\r\n          }\r\n        }\r\n        .icon_down {\r\n          position: absolute;\r\n          top: 45px;\r\n          right: 30px;\r\n          width: 16px;\r\n          height: 11px;\r\n\r\n        }\r\n        .van-collapse-item__content{\r\n          overflow auto;\r\n          max-height: 500px;\r\n          pdding: 0;\r\n          background-color $color-bgc-2\r\n          .van-cell{\r\n            width: 100%;\r\n            background-color $color-bgc-2\r\n            color: #fff;\r\n          }\r\n          ul {\r\n            li {\r\n              position relative;\r\n              height 86px;\r\n              line-height 86px;\r\n              height 86px;\r\n              padding-left:20px;\r\n              border-bottom: 1px solid #737577;\r\n\r\n            }\r\n            li:first-child {\r\n              background:rgba(34,40,50,0.9)\r\n\r\n            }\r\n          }\r\n         \r\n        }\r\n       .btn {\r\n            width: 100%\r\n            height 88px;\r\n            padding: 19px 0;\r\n            box-sizing border-box;\r\n            button {\r\n              width:49%;\r\n              height 50px;\r\n              line-height 50px;\r\n              background-color #222934;\r\n              color: #fff;\r\n              font-size: 30px;\r\n              text-align: center;\r\n              border: none;\r\n            }\r\n            .line {\r\n              display inline-block;\r\n              width: 0px;\r\n              height 50px\r\n              border-left: 2px dashed #fff;\r\n              vertical-align top;\r\n            }\r\n          }\r\n    \r\n    }\r\n    .select_layer:after {\r\n      position: absolute;\r\n      top: -0.379rem;\r\n      right: 0.186667rem;\r\n      content: '';\r\n      width: 0px;\r\n      height 0px;\r\n\r\n      border: 15px solid transparent;\r\n      border-bottom: 15px solid $color-bgc-2;\r\n      z-index: 9999\r\n    }\r\n  }\r\n</style>\r\n"]}]}