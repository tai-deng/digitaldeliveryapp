{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\user\\Modify.vue?vue&type=style&index=0&id=516616be&lang=stylus&scoped=true&rel=stylesheet%2Fstylus&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\user\\Modify.vue","mtime":1557998374665},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\css-loader\\index.js","mtime":1552270042900},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1552270044128},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1552270043529},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\stylus-loader\\index.js","mtime":1552270053417},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import './user_assets/base.css';\n\n.container-Modify {\n  width: 100%;\n  height: 100%;\n  background: rgba(246, 248, 250, 1);\n\n  .line {\n    margin: 0 0.4rem 0 0.32rem;\n    height: 0.027rem;\n    background-color: #E5E5E5;\n  }\n\n  .van-cell {\n    height: 1.17rem;\n    background: rgba(255, 255, 255, 1);\n    font-size: 30px;\n    font-family: SourceHanSansCN-Regular;\n    font-weight: 400;\n    color: rgba(51, 51, 51, 1);\n    align-items: center;\n    padding: 0 0.4rem 0 0.32rem;\n  }\n}\n",{"version":3,"sources":["Modify.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoJA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Modify.vue","sourceRoot":"src/components/user","sourcesContent":["\n<!-- 设置页面 Modify -->\n<template>\n  <div class=\"container-Modify\">\n    <van-nav-bar title=\"个人信息\" left-arrow border @click-left=\"onClickLeft\"></van-nav-bar>\n    <van-cell-group>\n      <van-field v-model=\"post.cName\" clearable input-align=\"right\" @blur=\"changeAll\" label=\"姓名\"/>\n      <div class=\"line\"></div>\n      <van-field v-model=\"post.cPhone\" clearable input-align=\"right\" @blur=\"changeAll\" label=\"手机号\"/>\n      <div class=\"line\"></div>\n\n      <van-field v-model=\"post.cDepName\"  input-align=\"right\" readonly label=\"部门\"/>\n      \n\n      <div class=\"line\"></div>\n      <!-- <van-field v-model=\"post.cRoleName\" input-align=\"right\" readonly label=\"岗位\"/> -->\n      <van-field  label=\"岗位\" right-icon=\"arrow\" input-align=\"right\"  disabled  v-model=\"operationCategory\"  @click-right-icon=\"choiceDep\"/>\n      <div class=\"line\"></div>\n      <van-field v-model=\"post.WeChatNo\" clearable input-align=\"right\" @blur=\"changeAll\" label=\"微信号\"/>\n      <div class=\"line\"></div>\n      <van-field v-model=\"post.Email\" clearable input-align=\"right\" @blur=\"changeAll\" label=\"邮箱\"/>\n    </van-cell-group>\n\n\n    <van-popup v-model=\"operationCategory_show\" position=\"bottom\" class=\"iPopup\">\n          <van-picker\n            show-toolbar\n            title=\"岗位选择\"\n            :columns=\"operationCategory_columns\"\n            @cancel=\"onOperationCategoryCancel\"\n            @confirm=\"onOperationCategoryConfirm\"/>\n    </van-popup>\n  </div>\n</template>\n\n<script type='textecmascript-6'> \nimport {MdfUser,GetLoginUserInfo,GetRoleList,UpdateRole,SaveUserRole} from '@/api/api.js'\nexport default {\n  data() {\n    return {\n      post:{},\n      operationCategory_show:false,//部门下拉是否显示\n      operationCategory_columns:[{value:'1',text:'测试员'},{value:'2',text:'消防员'}],\n      operationCategory:'',\n    };\n  },\n  created(){\n    // var text=localStorage.getItem('loginUserInfo');\n    // this.post=JSON.parse(text).loginUserInfo;\n    // console.log(JSON.parse(text));\n    this.getLogin();\n    this.GetRoleList();\n  },\n  methods: {\n    onClickLeft() {\n      this.$router.back(-1);\n    },\n    //失去焦点的时候修改个人信息---部门/岗位？？  cRoleName\n    changeAll(){\n      var projectid=localStorage.getItem('projectid');\n      var post={\n        CurUserID:this.post.ID,\n        UserName:this.post.cUserName,\n        Name:this.post.cName,\n        Tel:this.post.cPhone,\n        Email:this.post.Email,\n        WeChatNo:this.post.WeChatNo,\n        iSys_Dep_ID:this.post.iSys_Dep_ID,\n        iSys_Company_ID:this.post.iSys_Company_ID,\n        ProjectID:projectid,\n        Building:this.post.Building,\n        UserType:this.post.iUpdator,\n      };\n      this.Request(MdfUser(post)).then(res=>{\n        if(res.StatusCode=='200'){\n           this.$dialog.alert({message:'修改成功！'});\n        }else{\n          this.$dialog.alert({message:res.Message});\n        }\n      })\n    },\n    //根据登陆者的id查询个人信息\n    getLogin(){\n      var text=localStorage.getItem('userId');\n      this.Request(GetLoginUserInfo({curUserId:text})).then(res=>{\n        if(res.StatusCode=='200'){\n          this.post=res.Detiel[0].loginUserInfo;\n          this.post.ProjectID=res.Detiel[0].loginUserRoles[0].ProjectID;\n        }else{\n          this.$dialog.alert({message:res.Message});\n        }\n      })\n    },\n    //点击选择部门\n    choiceDep(){\n      if (!this.operationCategory_show) {\n        this.operationCategory_show = true;\n      } else {\n        this.operationCategory_show = false;\n      }\n    },\n    //选择部门\n    onOperationCategoryConfirm(value) {\n      this.post.cRoleName = value.id;\n      this.operationCategory=value.text;\n      this.UpdateRole();\n      this.operationCategory_show = false;\n    },\n    //取消选择部门\n    onOperationCategoryCancel() {\n      this.operationCategory_show = false;\n    },\n    //获取所有的岗位列表\n    GetRoleList(){\n      var projectid=localStorage.getItem('projectid');\n      this.Request(GetRoleList({ProjectID:projectid})).then(res=>{\n        if(res.StatusCode=='200'){\n          this.operationCategory_columns=res.Detiel;\n          // this.operationCategory=this.post.cRoleName;\n          // var list=this.operationCategory_columns.filter(i=>{\n          //   i.id=this.post.cRoleName;\n          // })\n          console.log('岗位',res.Detiel); //cRoleName\n          //登录的时候，页面显示问题\n          for(var i=0;i<this.operationCategory_columns.length;i++){\n            if(this.operationCategory_columns[i].text==this.post.cRoleName){\n              this.operationCategory=this.operationCategory_columns[i].text;\n            }\n          }\n          console.log('登录显示',this.post);\n        }else{\n          this.$dialog.alert({message:res.Message});\n        }\n      })\n    },\n    //修改角色  SaveUserRole ids角色id  uID用户 ID\n    UpdateRole(){\n      this.Request(SaveUserRole({ids:this.post.cRoleName,uID:this.post.ID,isCancel:'1'})).then(res=>{\n        console.log(res);\n      })\n    },\n\n\n  }\n};\n</script>\n<style lang='stylus' scoped rel='stylesheet/stylus'>\n\n@import './user_assets/base.css';\n\n.container-Modify {\n  width: 100%;\n  height: 100%;\n  background: rgba(246, 248, 250, 1);\n\n  .line {\n    margin: 0 0.4rem 0 0.32rem;\n    height: 0.027rem;\n    background-color: #E5E5E5;\n  }\n\n  .van-cell {\n    height: 1.17rem;\n    background: rgba(255, 255, 255, 1);\n    font-size: 30px;\n    font-family: SourceHanSansCN-Regular;\n    font-weight: 400;\n    color: rgba(51, 51, 51, 1);\n    align-items: center;\n    padding: 0 0.4rem 0 0.32rem;\n  }\n}\n</style>"]}]}