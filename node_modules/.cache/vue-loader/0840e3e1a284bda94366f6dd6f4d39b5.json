{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\index\\Risk\\Risk.vue?vue&type=style&index=0&id=1bbd8632&lang=stylus&scoped=true&rel=stylesheet%2Fstylus&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\index\\Risk\\Risk.vue","mtime":1558065367604},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\css-loader\\index.js","mtime":1552270042900},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1552270044128},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1552270043529},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\stylus-loader\\index.js","mtime":1552270053417},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.container-risk\n  width 100%\n  height 100%\n  .van-nav-bar\n    // height 88px\n    // line-height 88px\n    // border-bottom 1px solid #E5E5E5\n    .fontsize\n      // font-size 42px\n      // color #333\n      // display inline-block\n      // vertical-align middle\n    .speed_of_progress\n      width 36px\n      height 36px\n  .wrapper\n    margin-top 88px\n    .interlayer\n      width 100%\n      height 26px\n      background-color #F6F8FA\n",{"version":3,"sources":["Risk.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Risk.vue","sourceRoot":"src/components/index/Risk","sourcesContent":["<!-- Risk风险管理 -->\n<template>\n  <div class=\"container-risk\">\n    <!-- 头部 -->\n    <van-nav-bar title=\"风险管理\" @click-left=\"goBack\" @click-right=\"goProblemAnalysis\" fixed :border=\"false\" :z-index=\"100\" class=\"my-nav-bar\">\n      <span class=\"el-icon-arrow-left fontsize\" slot=\"left\"></span>\n      <img src=\"../../../assets/imgs/speed_of_progress.png\" class=\"speed_of_progress fontsize\" slot=\"right\">\n    </van-nav-bar>\n    <div class=\"wrapper\">\n      <van-tabs v-model=\"active\" swipeable animated sticky @change=\"handleIndex\" class=\"my-tabs\">\n        <!-- 整改中 begin -->\n        <van-tab :title=\"`整改中（${handlePageTotal}）`\">\n          <!-- 隔层 -->\n          <div class=\"interlayer\"></div>\n          <!-- Layout 布局 -->\n          <van-row type=\"flex\" justify=\"space-between\" align=\"center\" class=\"my-row row-head\">\n            <van-col span=\"4\">序号</van-col>\n            <van-col span=\"10\">主题</van-col>\n            <van-col span=\"6\">问题类型</van-col>\n            <van-col span=\"4\">状态</van-col>\n          </van-row>\n          <van-list\n            v-model=\"handleLoading\"\n            :finished=\"handleFinished\"\n            finished-text=\"没有更多了\"\n            :error.sync=\"errorHandle\"\n            error-text=\"请求失败，点击重新加载\"\n            @load=\"getRiskHandle\"\n            class=\"my-list\"\n          >\n            <van-row type=\"flex\" justify=\"space-between\" align=\"center\" class=\"my-row\" v-for=\"(item, index) in dataHandle\" :key=\"index\" @click.native=\"clickRow(item)\">\n              <van-col span=\"4\">{{index + 1}}</van-col>\n              <van-col span=\"10\" class=\"subject\">{{item.Subject}}</van-col>\n              <van-col span=\"6\">{{item.ProblemType}}</van-col>\n              <van-col span=\"4\">{{item.Status}}/3</van-col>\n            </van-row>\n          </van-list>\n        </van-tab>\n        <!-- 整改中 end -->\n\n        <!-- 待接收 begin -->\n        <van-tab :title=\"`待接收（${ingPageTotal}）`\">\n          <!-- 隔层 -->\n          <div class=\"interlayer\"></div>\n          <!-- Layout 布局 -->\n          <van-row type=\"flex\" justify=\"space-between\" align=\"center\" class=\"my-row row-head\">\n            <van-col span=\"4\">序号</van-col>\n            <van-col span=\"10\">主题</van-col>\n            <van-col span=\"6\">问题类型</van-col>\n            <van-col span=\"4\">状态</van-col>\n          </van-row>\n          <van-list\n            v-model=\"ingLoading\"\n            :finished=\"ingFinished\"\n            finished-text=\"没有更多了\"\n            :error.sync=\"errorIng\"\n            error-text=\"请求失败，点击重新加载\"\n            @load=\"getRiskIng\"\n            class=\"my-list\"\n          >\n            <van-row type=\"flex\" justify=\"space-between\" align=\"center\" class=\"my-row\" v-for=\"(item, index) in dataIng\" :key=\"index\" @click.native=\"clickRow(item)\">\n              <van-col span=\"4\">{{index + 1}}</van-col>\n              <van-col span=\"10\" class=\"subject\">{{item.Subject}}</van-col>\n              <van-col span=\"6\">{{item.ProblemType}}</van-col>\n              <van-col span=\"4\">{{item.Status}}/3</van-col>\n            </van-row>\n          </van-list>\n        </van-tab>\n        <!-- 待接收 end -->\n\n        <!-- 已整改 begin -->\n        <van-tab :title=\"`已整改（${overPageTotal}）`\">\n          <!-- 隔层 -->\n          <div class=\"interlayer\"></div>\n          <!-- Layout 布局 -->\n          <van-row type=\"flex\" justify=\"space-between\" align=\"center\" class=\"my-row row-head\">\n            <van-col span=\"4\">序号</van-col>\n            <van-col span=\"10\">主题</van-col>\n            <van-col span=\"6\">问题类型</van-col>\n            <van-col span=\"4\">状态</van-col>\n          </van-row>\n          <van-list\n            v-model=\"overLoading\"\n            :finished=\"overFinished\"\n            finished-text=\"没有更多了\"\n            :error.sync=\"errorOver\"\n            error-text=\"请求失败，点击重新加载\"\n            @load=\"getRiskOver\"\n            class=\"my-list\"\n          >\n            <van-row type=\"flex\" justify=\"space-between\" align=\"center\" class=\"my-row\" v-for=\"(item, index) in dataOver\" :key=\"index\" @click.native=\"clickRow(item)\">\n              <van-col span=\"4\">{{index + 1}}</van-col>\n              <van-col span=\"10\" class=\"subject\">{{item.Subject}}</van-col>\n              <van-col span=\"6\">{{item.ProblemType}}</van-col>\n              <van-col span=\"4\">{{item.Status}}/3</van-col>\n            </van-row>\n          </van-list>\n        </van-tab>\n        <!-- 已整改 end -->\n      </van-tabs>\n    </div>\n  </div>\n</template>\n\n<script type='textecmascript-6'>\nimport { GetRiskList } from \"@/api/api.js\";\nexport default {\n  data() {\n    return {\n      ProjectID: localStorage.getItem('projectid'), //项目ID\n      userID: localStorage.getItem(\"userId\"), //用户ID\n      loading: false,  //是否处于加载状态\n      finished: false,  //是否已加载完成\n      errorHandle: false,  //是否加载失败，加载失败后点击错误提示可以重新触发load事件，必须使用sync修饰符\n      errorIng: false,\n      errorOver: false,\n      dataIng: [],  //待接收\n      dataHandle: [],  //整改中\n      dataOver: [],  //已整改\n      ingLoading: false,\n      ingFinished: false,\n      handleLoading: false,\n      handleFinished: false,\n      overLoading: false,\n      overFinished: false,\n      pageTotal: 0,\n      currentPage: 1,\n      pageSize: 20,\n      ingCurrentPage: 1,\n      ingPageTotal: 0,  //待接收数\n      handleCurrentPage: 1,\n      handlePageTotal: 0,  //整改中数\n      overCurrentPage: 1,\n      overPageTotal: 0,  //已整改数\n      active: this.$route.query.active, //tab默认位置\n      titleArr: [\n        { value: 0, label: \"整改中（0条）\" },\n        { value: 1, label: \"待接收（0条）\" },\n        { value: 2, label: \"已整改（0条）\" }\n      ],\n      tableData: []\n    };\n  },\n  created() {\n    this.getRiskIng();  //待接收\n    this.getRiskHandle();  //整改中\n    this.getRiskOver();  //已整改\n  },\n  methods: {\n    /**\n     * @name 根据项目ID和状态获取风险管理问题列表（待接收）\n     * @param {string} projectId 项目ID\n     * @param {string} status 状态 0： 未整改 1： 整改中 2： 已整改\n     * @param {integer} pageIndex 页码\n     * @param {integer} pageSize 页大小\n     */\n    getRiskIng(){\n      this.ingLoading = true;\n      let params = {\n        ProjectID: this.ProjectID,\n        status: 0,\n        pageIndex: this.ingCurrentPage++,\n        pageSize: this.pageSize\n      }\n      this.Request(\n        GetRiskList(params),\n      ).then(data => {\n        if (data.StatusCode === 200) {\n          if(data.Detiel.length != 0){\n            this.ingPageTotal = parseInt(data.Count);\n            // this.titleArr[1].label = \"待接收（\"+ parseInt(data.Count) +\"条）\"\n            data.Detiel.forEach(element => {\n              this.dataIng.push({\n                Subject: element.Subject,\n                ProblemType: element.ProblemType,\n                Status: element.Status,\n                ID: element.ID\n              });\n            })\n            if(this.active === 1){\n              this.tableData = this.dataIng\n            }\n          }\n          this.ingLoading = false;  //加载状态关闭\n          // 数据全部加载完成\n          if (this.ingCurrentPage * this.pageSize >= data.Count) {\n            this.ingFinished = true;\n          }\n        } else {\n          this.$message({\n            type: \"error\",\n            message: data.Message,\n            center: \"true\"\n          });\n        }\n        this.ingLoading = false;\n      }).catch(() => {\n        this.errorIng = true;\n      });;\n    },\n    /**\n     * @name 根据项目ID和状态获取风险管理问题列表（整改中）\n     * @param {string} projectId 项目ID\n     * @param {string} status 状态 0： 未整改 1： 整改中 2： 已整改\n     * @param {integer} pageIndex 页码\n     * @param {integer} pageSize 页大小\n     */\n    getRiskHandle(){\n      this.handleLoading = true;  //加载状态打开\n      let params = {\n        ProjectID: this.ProjectID,\n        status: 1,\n        pageIndex: this.handleCurrentPage++,\n        pageSize: this.pageSize\n      }\n      this.Request(\n        GetRiskList(params),\n      ).then(data => {\n        if (data.StatusCode === 200) {\n          if(data.Detiel.length != 0){\n            this.handlePageTotal = parseInt(data.Count);\n            // this.titleArr[0].label = \"整改中（\"+ parseInt(data.Count) +\"条）\"\n            data.Detiel.forEach(element => {\n              this.dataHandle.push({\n                Subject: element.Subject,\n                ProblemType: element.ProblemType,\n                Status: element.Status,\n                ID: element.ID\n              });\n            })\n            if(this.active === 0){\n              this.tableData = this.dataHandle\n            }\n          }\n          this.handleLoading = false;  //加载状态关闭\n          // 数据全部加载完成\n          if (this.handleCurrentPage * this.pageSize >= data.Count) {\n            this.handleFinished = true;\n          }\n        } else {\n          this.$message({\n            type: \"error\",\n            message: data.Message,\n            center: \"true\"\n          });\n        }\n        this.handleLoading = false;\n      }).catch(() => {\n        this.errorHandle = true;\n      });\n    },\n    /**\n     * @name 根据项目ID和状态获取风险管理问题列表（已整改）\n     * @param {string} projectId 项目ID\n     * @param {string} status 状态 0： 未整改 1： 整改中 2： 已整改\n     * @param {integer} pageIndex 页码\n     * @param {integer} pageSize 页大小\n     */\n    getRiskOver(){\n      this.overLoading = true;\n      let params = {\n        ProjectID: this.ProjectID,\n        status: 2,\n        pageIndex: this.overCurrentPage++,\n        pageSize: this.pageSize\n      }\n      this.Request(\n        GetRiskList(params),\n      ).then(data => {\n        if (data.StatusCode === 200 && typeof(\"data.StatusCode\") != \"undefined\") {\n          if(data.Detiel.length != 0){\n            this.overPageTotal = parseInt(data.Count);\n            // this.titleArr[2].label = \"已整改（\"+ parseInt(data.Count) +\"条）\"\n            // this.dataOver = data.Detiel;\n            data.Detiel.forEach(element => {\n              this.dataOver.push({\n                Subject: element.Subject,\n                ProblemType: element.ProblemType,\n                Status: element.Status,\n                ID: element.ID\n              });\n            })\n            if(this.active === 2){\n              this.tableData = this.dataOver\n            }\n          }\n          this.overLoading = false;  //加载状态关闭\n          // 数据全部加载完成\n          if (this.overCurrentPage * this.pageSize >= data.Count) {\n            this.overFinished = true;\n          }\n        } else {\n          this.$message({\n            type: \"error\",\n            message: data.Message,\n            center: \"true\"\n          });\n        }\n        this.overLoading = false;\n      }).catch(() => {\n        this.errorOver = true;\n      });\n    },\n    /**\n     * @name 滚动条与底部距离小于offset时触发\n     */\n    onLoad(){\n      switch (this.active) {\n        case 0:\n          {\n            this.getRiskHandle();  //整改中\n          }\n          break;\n        case 1:\n          {\n            this.getRiskIng();  //待接收\n          }\n          break;\n        case 2:\n          {\n            this.getRiskOver();  //已整改\n          }\n          break;\n      \n        default:\n          break;\n      }\n    },\n    //tab切换\n    handleIndex() {\n      console.log(\"active\", this.active);\n      switch (this.active) {\n        case 0:\n          {\n            this.tableData = this.dataHandle\n          }\n          break;\n        case 1:\n          {\n            this.tableData = this.dataIng\n          }\n          break;\n        case 2:\n          {\n            this.tableData = this.dataOver\n          }\n          break;\n      \n        default:\n          break;\n      }\n    },\n    formatterState(row, column){\n      return row.Status + \"/3\"\n    },\n    //返回\n    goBack() {\n      this.$router.push({ path: \"/nav/to/index\" });\n    },\n    //跳转问题类型分析\n    goProblemAnalysis() {\n      this.$router.push({ path: \"/ProblemAnalysis\" });\n    },\n    //点击表格行\n    clickRow(row) {\n      console.log('row',row)\n      this.$router.push({ path: \"/riskDetails\", query: {active: this.active, riskID: row.ID, state: row.Status} });\n    },\n  },\n  mounted(){},\n  watch:{\n    // active(v){\n    //   console.log(\"-------\",v)\n    // }\n    // $route: {\n    //   handler: function(val, oldVal){\n    //     console.log(\"==\",val);\n    //   },\n    //   // 深度观察监听\n    //   deep: true\n    // }\n  }\n};\n</script>\n<style lang='stylus' scoped rel='stylesheet/stylus'>\n.container-risk\n  width 100%\n  height 100%\n  .van-nav-bar\n    // height 88px\n    // line-height 88px\n    // border-bottom 1px solid #E5E5E5\n    .fontsize\n      // font-size 42px\n      // color #333\n      // display inline-block\n      // vertical-align middle\n    .speed_of_progress\n      width 36px\n      height 36px\n  .wrapper\n    margin-top 88px\n    .interlayer\n      width 100%\n      height 26px\n      background-color #F6F8FA\n</style>\n<style>\n@import \"~@/assets/css/resetVant.css\";\n.container-risk .my-row.row-head{\n  background: rgba(88,146,255,1);\n}\n.container-risk .my-row.row-head .van-col{\n  color: rgba(255,255,255,1);\n}\n.container-risk .my-row{\n  width:100%;\n  height:80px;\n  /* line-height: 80px; */\n}\n.container-risk .my-row .van-col.subject{\n  text-align: left;\n  overflow:hidden;\n  text-overflow:ellipsis;\n  white-space:nowrap\n}\n.container-risk .my-row .van-col{\n  text-align: center;\n}\n.container-risk .my-list .my-row{\n  border-bottom: 1px solid rgba(229,229,229,1);  /*no*/\n}\n.my-list .van-list__loading-text, .my-list .van-list__finished-text, .my-list .van-list__error-text{\n    line-height: 80px\n}\n/* 顶部表头 */\n/* .container-risk .van-nav-bar .van-nav-bar__title {\n  font-size: 36px;\n} */\n/*tab切换栏*/\n/* .container-risk .van-tab span {\n  font-size: 30px;\n  line-height: 80px;\n}\n.container-risk .van-tabs--line .van-tabs__wrap {\n  height: 80px;\n}\n.container-risk .van-tabs--line .van-tabs__wrap {\n  color: #666;\n  position: fixed;\n  top: 88px !important;\n}\n.container-risk .van-tabs--line .van-tabs__wrap .van-tabs__nav {\n  background-color: #fff;\n}\n.container-risk .van-tab--active {\n  color: #5a92ff;\n} */\n/* tab下边线 */\n/* .container-risk .van-hairline--top-bottom::after {\n  border-width: 0 0 2px 0;\n}\n.container-risk .van-tabs--line {\n  padding-top: 80px;\n}\n */\n.container-risk .van-tabs__line {\n  background-color: #5a92ff;\n}\n/*表格*/\n.container-risk .el-table thead tr th {\n  background-color: #5892ff;\n  color: #fff;\n}\n/* .container-risk .el-table {\n  color: #333;\n  font-size: 24px;\n}\n.container-risk .el-table .cell {\n  line-height: 76px;\n}\n.container-risk .el-table th div {\n  vertical-align: middle;\n  color: #fff;\n} */\n</style>\n"]}]}