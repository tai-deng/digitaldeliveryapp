{"remainingRequest":"C:\\Users\\Public\\软件\\app\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Public\\软件\\app\\src\\components\\user\\communicateDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Public\\软件\\app\\src\\components\\user\\communicateDetail.vue","mtime":1557998374653},{"path":"C:\\Users\\Public\\软件\\app\\.babelrc","mtime":1553246877633},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":1552270024016},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552270042041},{"path":"C:\\Users\\Public\\软件\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1552270044128}],"contextDependencies":[],"result":["import _parseInt from \"C:\\\\Users\\\\Public\\\\\\u8F6F\\u4EF6\\\\app\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-int\";\nimport _Object$assign from \"C:\\\\Users\\\\Public\\\\\\u8F6F\\u4EF6\\\\app\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/assign\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Public\\\\\\u8F6F\\u4EF6\\\\app\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { GetCommunicateList } from '@/api/api.js';\nexport default {\n  data: function data() {\n    return {\n      projectid: localStorage.getItem('projectid'),\n      pageIndex: 1,\n      pageSize: 15,\n      sel_show: false,\n      active: 0,\n      dataHandle: [],\n      // 进行中\n      dataOver: [],\n      //已完成\n      activeNames: ['0'],\n      titleArr: [{\n        value: 0,\n        label: \"整改中（0条）\"\n      }, {\n        value: 1,\n        label: \"待接收（0条）\"\n      }, {\n        value: 2,\n        label: \"已整改（0条）\"\n      }],\n      tableData: [],\n      // 人力物资列表数据\n      dataIng: [],\n      ingPageTotal: 0,\n      handlePageTotal: 0,\n      overPageTotal: 0,\n      statusList: ['', '0', '1', '2'],\n      //状态为空字符串时查询全部， 0： 待接收 1： 处理中 2： 已处理\n      ingLoading: false,\n      //待接收状态\n      handleLoading: false,\n      // 进行中状态\n      overLoading: false,\n      // 已完成状态\n      scrollLoader: false,\n      //上啦加载\n      screenWidth: 0 // 屏幕宽\n\n    };\n  },\n  created: function created() {\n    this.screenWidth = window.screen.width;\n    this.getcommunicating(this.statusList[1]);\n    this.getcommunicating(this.statusList[2]);\n    this.getcommunicating(this.statusList[3]);\n  },\n  updated: function updated() {\n    this.scrcllFun();\n  },\n  methods: {\n    // 返回按钮\n    onClickLeft: function onClickLeft() {\n      this.$router.go(-1);\n    },\n    // 重置函数 \n    resetFunc: function resetFunc() {\n      console.log(\"chongzhi\");\n      this.sel_show = false;\n    },\n    //确认函数 \n    recordCheck: function recordCheck() {\n      console.log('queren');\n      this.sel_show = false;\n    },\n    // 表格合并单元格\n    arraySpanMethod: function arraySpanMethod(_ref) {\n      var columnIndex = _ref.columnIndex;\n\n      if (columnIndex === 5) {\n        return [6, 1];\n      } else if (columnIndex === 4) {\n        return [6, 1];\n      }\n    },\n    // 跳转至详情\n    goToDetail: function goToDetail(row, event, column) {\n      console.log(row);\n      console.log(event);\n      console.log(column);\n      this.$router.push({\n        path: \"talking\",\n        query: {\n          id: row.ID\n        }\n      });\n    },\n    //切换栏函数\n    handleIndex: function handleIndex(index, title) {\n      console.log(index);\n      console.log(title);\n\n      if (index === 0) {\n        this.tableData = this.dataHandle;\n      } else if (index === 1) {\n        this.tableData = this.dataIng;\n      } else if (index === 2) {\n        this.tableData = this.dataOver;\n      }\n    },\n    // 下拉加载更多\n    scrcllFun: function scrcllFun() {\n      var that = this;\n      console.log(this.$refs[\"scrollBox\".concat(this.active)]);\n      var scrollEl = this.$refs[\"scrollBox\".concat(this.active)][0];\n\n      scrollEl.onscroll = function () {\n        var scrollH = scrollEl.scrollHeight;\n        var scrollT = scrollEl.scrollTop;\n        var screenH = window.screen.height;\n        var rel = scrollT / (scrollH + 141 - screenH);\n        console.log(scrollT);\n\n        if (rel >= 1 && !that.scrollLoader) {\n          that.scrollLoader = true;\n\n          if (that.active === 0) {\n            if (that.handlePageTotal > that.tableData.length) {\n              that.pageSize += that.pageSize;\n              that.CommunicateList(that.active);\n            } else {\n              that.$toast({\n                message: '没有更多数据了',\n                duration: 800\n              });\n              that.scrollLoader = false;\n            }\n          } else if (that.active === 1) {\n            if (that.ingPageTotal > that.tableData.length) {\n              that.pageSize += that.pageSize;\n              that.CommunicateList(that.active);\n            } else {\n              that.$toast({\n                message: '没有更多数据了',\n                duration: 800\n              });\n              that.scrollLoader = false;\n            }\n          } else if (that.active === 2) {\n            if (that.overPageTotal > that.tableData.length) {\n              that.pageSize += that.pageSize;\n              that.CommunicateList(that.active);\n            } else {\n              that.$toast({\n                message: '没有更多数据了',\n                duration: 800\n              });\n              that.scrollLoader = false;\n            }\n          }\n        }\n      };\n    },\n\n    /**\r\n     * 根据项目ID和状态获取沟通管理问题列表\r\n     */\n    getcommunicating: function getcommunicating(state) {\n      if (state === '0') {\n        this.ingLoading = true;\n      } else if (state === '1') {\n        this.handleLoading = true;\n      } else if (state === '2') {\n        this.overLoading = true;\n      } else if (state === '') {\n        this.allLoading = true;\n      } else {\n        return false;\n      }\n\n      this.CommunicateList(state);\n    },\n\n    /**\r\n     * api接口\r\n     */\n    // 根据项目ID获取沟通管理列表\n    CommunicateList: function () {\n      var _CommunicateList = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(state) {\n        var data, res, newData, tData;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // this.load()\n                data = {\n                  projectId: this.projectid,\n                  status: state,\n                  pageIndex: this.pageIndex,\n                  pageSize: this.pageSize\n                };\n                _context.next = 3;\n                return this.Request(GetCommunicateList(data));\n\n              case 3:\n                res = _context.sent;\n                console.log('沟通管理......');\n                console.log(res);\n\n                if (res.StatusCode === 200) {\n                  newData = [];\n                  tData = {};\n                  res.Detiel.forEach(function (item, i) {\n                    tData = _Object$assign({\n                      index: \"\".concat(i + 1)\n                    }, item.Communicate);\n                    tData.dCreateTime = item.Communicate.dCreateTime.substr(0, 10);\n                    tData.Status = \"\".concat(item.Communicate.DoNum, \"/\").concat(item.Communicate.TotalDoNum);\n                    newData.push(tData);\n                  });\n\n                  if (data.status === '0') {\n                    this.dataIng = newData;\n                    this.ingPageTotal = _parseInt(res.Count);\n                    this.titleArr[1].label = \"\\u5F85\\u63A5\\u6536\\uFF08\".concat(_parseInt(res.Count), \"\\u6761\\uFF09\");\n                    this.ingLoading = false;\n                    console.log(this.dataIng);\n                  } else if (data.status === '1') {\n                    this.dataHandle = newData;\n                    this.handlePageTotal = _parseInt(res.Count);\n                    this.titleArr[0].label = \"\\u6574\\u6539\\u4E2D\\uFF08\".concat(_parseInt(res.Count), \"\\u6761\\uFF09\");\n\n                    if (this.active === 0) {\n                      this.tableData = this.dataHandle;\n                    }\n\n                    this.handleLoading = false;\n                    console.log(this.dataHandle);\n                  } else if (data.status === '2') {\n                    this.dataOver = newData;\n                    this.overLoading = false;\n                    this.overPageTotal = _parseInt(res.Count);\n                    this.titleArr[2].label = \"\\u5DF2\\u6574\\u6539\\uFF08\".concat(_parseInt(res.Count), \"\\u6761\\uFF09\");\n                    console.log(this.dataOver);\n                  }\n\n                  this.scrollLoader = false;\n                } else {\n                  this.$message({\n                    type: 'error',\n                    message: res.Message,\n                    center: 'true'\n                  });\n                } // this.$toast.clear()\n\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function CommunicateList(_x) {\n        return _CommunicateList.apply(this, arguments);\n      }\n\n      return CommunicateList;\n    }()\n  }\n};",{"version":3,"sources":["communicateDetail.vue"],"names":[],"mappings":"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","sourcesContent":["<!-- communicate_detail 沟通管理 -->\r\n<template>\r\n <div class='communicate_detail' >\r\n    <div class='wrapper' id=\"hum_wrapper\">\r\n        <!-- 头部 -->\r\n        <div class=\"header\">\r\n            <van-nav-bar\r\n                title=\"沟通管理\"\r\n                left-arrow\r\n                @click-left=\"onClickLeft\"\r\n            >\r\n            <!-- <div class=\"nav_right\" slot=\"right\"> <img src=\"../../assets/imgs/screen.png\" alt=\"\" /> </div> -->\r\n            </van-nav-bar>\r\n        </div>\r\n        <van-tabs v-model=\"active\" :line-width=\"88\" sticky color=\"#5A92FF\" @change=\"handleIndex\">\r\n          <van-tab v-for=\"item in titleArr\" :key=\"item.value\" :title=\"item.label\">\r\n             <!-- 隔层 -->\r\n            <div class=\"interlayer\"></div>\r\n\r\n            <div class=\"content\">\r\n                  <!-- 沟通管理列表 -->\r\n              <div class=\"communicate_content\">\r\n                  <el-table\r\n                      :header-row-style = \"{'background-color': '#5A92FF', 'color': '#fff','height': '40px'}\">\r\n                      <el-table-column\r\n                          prop=\"type\"\r\n                          label=\"类型\"\r\n                          width=\"80\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"themeContent\"\r\n                          label=\"主题\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"createTime\"\r\n                          label=\"发起时间\"\r\n                          width=\"110\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"state\"\r\n                          label=\"状态\"\r\n                          width=\"60\">\r\n                      </el-table-column>\r\n                  </el-table>\r\n              </div>             \r\n              <div :ref=\"`scrollBox${item.value}`\" class=\"com_content_list\">\r\n                  <el-table\r\n                  v-loading=\"ingLoading\"\r\n                  :data=\"tableData\"\r\n                  :show-header=\"false\"\r\n                  @row-click=\"goToDetail\">\r\n                      <el-table-column\r\n                          prop=\"ComType\"\r\n                          label=\"类型\"\r\n                          width=\"80\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"Subject\"\r\n                          label=\"主题\">\r\n                      </el-table-column>\r\n                      <el-table-column\r\n                          prop=\"dCreateTime\"\r\n                          label=\"发起时间\"\r\n                          width=\"110\">\r\n                      </el-table-column>\r\n                          <el-table-column\r\n                          prop=\"Status\"\r\n                          label=\"状态\"\r\n                          width=\"60\">\r\n                      </el-table-column>\r\n                  </el-table>\r\n                  <div v-loading=\"scrollLoader\" class=\"loader\" :style=\"{width: screenWidth+'px'}\"></div>\r\n              </div>\r\n            </div>\r\n          </van-tab>\r\n        </van-tabs>\r\n    </div>\r\n </div>\r\n</template>\r\n\r\n<script type='textecmascript-6'>\r\nimport{GetCommunicateList,\r\n} from '@/api/api.js'\r\nexport default {\r\n data() {\r\n   return {\r\n    projectid: localStorage.getItem('projectid'),  \r\n    pageIndex: 1,\r\n    pageSize: 15,\r\n    sel_show: false,\r\n    active: 0,\r\n    dataHandle: [], // 进行中\r\n    dataOver: [],   //已完成\r\n    activeNames: ['0'],\r\n    titleArr: [\r\n      { value: 0, label: \"整改中（0条）\" },\r\n      { value: 1, label: \"待接收（0条）\" },\r\n      { value: 2, label: \"已整改（0条）\" }\r\n    ],\r\n    tableData: [],\r\n    // 人力物资列表数据\r\n    dataIng: [],\r\n    ingPageTotal: 0,\r\n    handlePageTotal: 0,\r\n    overPageTotal: 0,\r\n    statusList: ['', '0','1','2'], //状态为空字符串时查询全部， 0： 待接收 1： 处理中 2： 已处理\r\n    ingLoading: false,   //待接收状态\r\n    handleLoading: false, // 进行中状态\r\n    overLoading: false, // 已完成状态\r\n    scrollLoader: false, //上啦加载\r\n    screenWidth: 0  // 屏幕宽\r\n    }\r\n    },\r\n    created(){\r\n        this.screenWidth = window.screen.width;\r\n        this.getcommunicating(this.statusList[1])\r\n        this.getcommunicating(this.statusList[2])\r\n        this.getcommunicating(this.statusList[3])\r\n    },\r\n    updated(){\r\n      this.scrcllFun()\r\n    },\r\n    methods: {\r\n         // 返回按钮\r\n        onClickLeft() {\r\n        this.$router.go(-1)\r\n        },\r\n\r\n        // 重置函数 \r\n        resetFunc() {\r\n        console.log(\"chongzhi\")\r\n        this.sel_show = false;\r\n        },\r\n        //确认函数 \r\n        recordCheck() {\r\n        console.log('queren')\r\n        this.sel_show = false;\r\n\r\n        },\r\n        // 表格合并单元格\r\n        arraySpanMethod({ columnIndex }) {\r\n        \r\n            if (columnIndex === 5) {\r\n                return [6, 1];\r\n            } else if (columnIndex === 4) {\r\n                return [6, 1];\r\n            }\r\n            },\r\n        // 跳转至详情\r\n        goToDetail(row, event, column) {\r\n        console.log(row)\r\n        console.log(event)\r\n        console.log(column)\r\n        this.$router.push({\r\n            path: \"talking\",\r\n            query: {\r\n            id: row.ID,\r\n            }\r\n        });\r\n        },\r\n        //切换栏函数\r\n        handleIndex( index, title){\r\n          console.log(index)\r\n          console.log(title)\r\n          if(index === 0){\r\n            this.tableData = this.dataHandle\r\n          } else if(index === 1){\r\n            this.tableData = this.dataIng\r\n          } else if(index === 2){\r\n            this.tableData = this.dataOver\r\n          }\r\n          \r\n        },\r\n        // 下拉加载更多\r\n        scrcllFun(){\r\n          let that = this\r\n          console.log(this.$refs[`scrollBox${this.active}`])\r\n          let scrollEl = this.$refs[`scrollBox${this.active}`][0]\r\n          scrollEl.onscroll = function(){\r\n            let scrollH = scrollEl.scrollHeight;\r\n            let scrollT = scrollEl.scrollTop\r\n            let screenH = window.screen.height;\r\n            let rel = scrollT /(scrollH + 141 - screenH )\r\n            console.log(scrollT)\r\n            if(rel>=1&& !that.scrollLoader){\r\n              that.scrollLoader = true\r\n              if(that.active === 0){\r\n                if(that.handlePageTotal > that.tableData.length){\r\n                  that.pageSize += that.pageSize\r\n                  that.CommunicateList(that.active)\r\n                }else {\r\n                  that.$toast({\r\n                    message: '没有更多数据了',\r\n                    duration: 800\r\n                  })\r\n                  that.scrollLoader = false\r\n                }\r\n                \r\n              } else if(that.active === 1){\r\n                if(that.ingPageTotal > that.tableData.length){\r\n                  that.pageSize += that.pageSize\r\n                  that.CommunicateList(that.active)\r\n                }else {\r\n                  that.$toast({\r\n                    message: '没有更多数据了',\r\n                    duration: 800\r\n                  })\r\n                  that.scrollLoader = false\r\n                }\r\n\r\n              } else if(that.active === 2){\r\n                if(that.overPageTotal > that.tableData.length){\r\n                  that.pageSize += that.pageSize\r\n                  that.CommunicateList(that.active)\r\n                }else {\r\n                  that.$toast({\r\n                    message: '没有更多数据了',\r\n                    duration: 800\r\n                  })\r\n                  that.scrollLoader = false\r\n                }\r\n\r\n              }\r\n            }\r\n          }\r\n          \r\n        },\r\n        /**\r\n         * 根据项目ID和状态获取沟通管理问题列表\r\n         */  \r\n        getcommunicating(state){\r\n        if(state === '0') {\r\n            this.ingLoading = true;\r\n        }else if(state === '1'){\r\n            this.handleLoading = true\r\n        } else if(state === '2'){\r\n            this.overLoading = true\r\n        } else if(state === ''){\r\n            this.allLoading = true\r\n        } else {\r\n            return false\r\n        }\r\n        this.CommunicateList(state)\r\n        },\r\n        /**\r\n         * api接口\r\n         */\r\n         // 根据项目ID获取沟通管理列表\r\n        async CommunicateList (state){\r\n        // this.load()\r\n        let data = {\r\n            projectId: this.projectid,\r\n            status: state,\r\n            pageIndex: this.pageIndex,\r\n            pageSize: this.pageSize\r\n        }\r\n\r\n        let res = await this.Request(GetCommunicateList(data))\r\n        console.log('沟通管理......')\r\n        console.log(res)\r\n        if(res.StatusCode === 200) {\r\n            let newData = []\r\n            let tData = {}\r\n            res.Detiel.forEach((item, i) => {\r\n                tData = Object.assign({index: `${i+1}`},item.Communicate)\r\n                tData.dCreateTime = item.Communicate.dCreateTime.substr(0, 10)\r\n                tData.Status = `${item.Communicate.DoNum}/${item.Communicate.TotalDoNum}`\r\n                newData.push(tData)\r\n            })\r\n        \r\n            if(data.status === '0'){ \r\n            this.dataIng = newData\r\n            this.ingPageTotal = parseInt(res.Count)\r\n            this.titleArr[1].label = `待接收（${parseInt(res.Count)}条）`\r\n            this.ingLoading = false\r\n            console.log(this.dataIng)\r\n        \r\n            }else if(data.status === '1'){\r\n            this.dataHandle = newData\r\n            this.handlePageTotal = parseInt(res.Count)\r\n            this.titleArr[0].label = `整改中（${parseInt(res.Count)}条）`\r\n            if(this.active === 0){\r\n              this.tableData = this.dataHandle\r\n            }\r\n            this.handleLoading = false\r\n            console.log(this.dataHandle)\r\n            } else if( data.status === '2'){\r\n            this.dataOver = newData\r\n            this.overLoading = false \r\n            this.overPageTotal = parseInt(res.Count)\r\n            this.titleArr[2].label = `已整改（${parseInt(res.Count)}条）`\r\n            console.log(this.dataOver)\r\n            }\r\n            this.scrollLoader = false\r\n            \r\n        }else {\r\n            this.$message({\r\n            type: 'error',\r\n            message: res.Message,\r\n            center: 'true'\r\n            })\r\n        }\r\n        // this.$toast.clear()\r\n        },\r\n    }\r\n    \r\n}\r\n\r\n</script>\r\n<style lang='stylus' scoped rel='stylesheet/stylus'>\r\n.communicate_detail\r\n  width 100%\r\n  height 100%\r\n</style>\r\n<style lang=\"stylus\" rel='stylesheet/stylus'>\r\n@import '../../assets/stylus/variable'\r\n  #hum_wrapper {\r\n    // overflow-x: scroll;\r\n    width: 100%;\r\n    height: 100%;\r\n    //头部样式\r\n    .header {\r\n    // position: fixed;\r\n    // top: 0px;\r\n    // left: 0px;\r\n    width: 100%;\r\n    \r\n    z-index: 30;\r\n    }\r\n    .van-tabs--line {\r\n      padding-top: 88px;\r\n      height: calc(100% - 88px)\r\n      box-sizing: border-box;\r\n      .van-tabs__content {\r\n        height: 100%\r\n        overflow-x: auto;\r\n        .van-tab__pane {\r\n          height: 100%;\r\n        }\r\n      }\r\n    }\r\n    .interlayer {\r\n      width 100%\r\n      height 26px\r\n      background-color #F6F8FA\r\n    }\r\n   \r\n    .van-tabs__wrap {\r\n      height: 88px;\r\n      .van-ellipsis {\r\n        display: inline-block;\r\n        height: 88px;\r\n        line-height: 88px;\r\n        font-size:28px;\r\n        font-family:PingFang-SC-Bold;\r\n        font-weight:bold;\r\n        box-sizing: border-box;\r\n        color: #666;\r\n      }\r\n      .van-tab--active .van-ellipsis {\r\n        color: #5A92FF;\r\n      }\r\n    }\r\n    .content {\r\n        // position:fixed;\r\n        // top: 88px;\r\n        // left: 0px;\r\n        // margin-top: 88px;\r\n        width: 100%;\r\n        height: calc(100% - 26px)\r\n        box-sizing: border-box;\r\n        overflow-x: auto;\r\n    }\r\n    .van-nav-bar {\r\n      width: 100%;  \r\n      height: 88px;\r\n      border-bottom: 1px solid #E5E5E5;\r\n      box-sizing: border-box;\r\n\r\n      .van-nav-bar__title,\r\n      .van-nav-bar__left,\r\n      .van-nav-bar__right {\r\n        color: #000;\r\n        height: 88px;\r\n        // // padding-top: 41px;\r\n        line-height: 88px;\r\n        font-size $font-size-title;\r\n        box-sizing: border-box;\r\n        z-index 100;\r\n      }\r\n      .van-icon-arrow-left {\r\n        color: #000 ;\r\n        font-size $font-size-title;\r\n      }\r\n      .van-nav-bar__text {\r\n        color: #000;\r\n        font-size $font-size-title;\r\n      }\r\n      // .nav_right {\r\n      //   img {\r\n      //       width: 41px;\r\n      //     height 35px;\r\n          \r\n      //   }\r\n      // }\r\n    }\r\n    // 沟通管理列表样式 \r\n    .communicate_content {\r\n        // position: absolute;\r\n        // top: 0px;\r\n        // left: 0px;\r\n        width: 908px;\r\n        z-index: 30;\r\n        .el-table__body-wrapper {\r\n            display: none;\r\n        }  \r\n    }\r\n    \r\n    .com_content_list {\r\n      overflow-y:auto;\r\n      overflow-x: hidden;\r\n      // padding-top: 80px;\r\n      width: 908px;\r\n      height: calc(100% - 80px)\r\n      .loader {\r\n        position: fixed!important;\r\n        left: 0px;\r\n        bottom: 0px;\r\n        height: 88px;\r\n      }\r\n    }\r\n    .el-table {\r\n        .cell {\r\n            line-height 60px\r\n        }\r\n      .el-table__header-wrapper {\r\n        tr {\r\n          th {\r\n            background-color: #5A92FF\r\n            padding: 0px!important;\r\n            .cell {\r\n                height 100%;\r\n                line-height 60px;\r\n                text-align: center;\r\n                font-size: 30px;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .el-table__body-wrapper {\r\n        tr {\r\n            height 80px;\r\n          td {\r\n            height 80px;\r\n            font-size: 28px;\r\n            text-align: center;\r\n            color: #333;\r\n          }\r\n        }\r\n         //左上角图标样\r\n\r\n        tr:nth-child(2n+1):after {\r\n        // display: inline-block;\r\n        // content: '滞';\r\n        // font-size: 20px;\r\n        // padding 10px 0 0 10px;\r\n        // width: 60px\r\n        // height: 60px;\r\n        // color: #fff;\r\n        // background url('../../assets/imgs/mark.png') center center no-repeat;\r\n        // transform: translate(-1134%, 0)\r\n        }\r\n      }\r\n    }\r\n\r\n    // 筛选样式\r\n     .select_layer {\r\n      position: fixed;\r\n      top: 126px;\r\n      right: 24px;\r\n      width 352px;\r\n      box-sizing: border-box;\r\n      background:rgba(34,40,50,1)\r\n      border-radius:8px\r\n      padding 10px 20px;\r\n      z-index: 999\r\n        .van-hairline--top-bottom::after{\r\n          border: none;\r\n        }\r\n        .van-hairline--top::after {\r\n          border-top: none;\r\n          border-bottom: 1px solid #737577;\r\n        }\r\n        .van-collapse  {\r\n          max-height 909px;\r\n        }\r\n        .van-collapse-item{\r\n          .van-collapse-item__title--expanded::after {\r\n            visibility hidden\r\n          }\r\n        }\r\n        .van-collapse-item:first-child {\r\n          border-bottom: 1px solid #737577;\r\n        }\r\n        .van-collapse-item__title {\r\n          height 86px;\r\n          line-height 86px;\r\n          height 86px;\r\n         \r\n          background-color $color-bgc-2;\r\n         \r\n          .van-cell__title{\r\n            font-size 30px;\r\n            color #fff;\r\n            text-align left;         \r\n          }\r\n          .van-cell__right-icon {\r\n            color: transparent;\r\n          }\r\n        }\r\n        .icon_down {\r\n          position: absolute;\r\n          top: 45px;\r\n          right: 30px;\r\n          width: 16px;\r\n          height: 11px;\r\n\r\n        }\r\n        .van-collapse-item__content{\r\n          overflow auto;\r\n          max-height: 500px;\r\n          pdding: 0;\r\n          background-color $color-bgc-2\r\n          .van-cell{\r\n            width: 100%;\r\n            background-color $color-bgc-2\r\n            color: #fff;\r\n          }\r\n          ul {\r\n            li {\r\n              position relative;\r\n              height 86px;\r\n              line-height 86px;\r\n              height 86px;\r\n              padding-left:20px;\r\n              border-bottom: 1px solid #737577;\r\n\r\n            }\r\n            li:first-child {\r\n              background:rgba(34,40,50,0.9)\r\n\r\n            }\r\n          }\r\n         \r\n        }\r\n       .btn {\r\n            width: 100%\r\n            height 88px;\r\n            padding: 19px 0;\r\n            box-sizing border-box;\r\n            button {\r\n              width:49%;\r\n              height 50px;\r\n              line-height 50px;\r\n              background-color #222934;\r\n              color: #fff;\r\n              font-size: 30px;\r\n              text-align: center;\r\n              border: none;\r\n            }\r\n            .line {\r\n              display inline-block;\r\n              width: 0px;\r\n              height 50px\r\n              border-left: 2px dashed #fff;\r\n              vertical-align top;\r\n            }\r\n          }\r\n    \r\n    }\r\n    .select_layer:after {\r\n      position: absolute;\r\n      top: -0.379rem;\r\n      right: 0.186667rem;\r\n      content: '';\r\n      width: 0px;\r\n      height 0px;\r\n\r\n      border: 15px solid transparent;\r\n      border-bottom: 15px solid $color-bgc-2;\r\n      z-index: 9999\r\n    }\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/components/user"}]}